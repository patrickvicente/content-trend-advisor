[0m06:04:38.125723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2f0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f448210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ee945d0>]}


============================== 06:04:38.134752 | 2232e8a0-169d-4e43-a184-5a59239dc1fd ==============================
[0m06:04:38.134752 [info ] [MainThread]: Running with dbt=1.7.8
[0m06:04:38.135219 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'write_json': 'True', 'log_format': 'default', 'introspect': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'cache_selected_only': 'False', 'log_path': '/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'target_path': 'None', 'profiles_dir': '/dbt', 'debug': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'quiet': 'False', 'warn_error': 'None', 'static_parser': 'True'}
[0m06:04:38.199805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2232e8a0-169d-4e43-a184-5a59239dc1fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f4e7a90>]}
[0m06:04:38.204748 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-64uvo_uo'
[0m06:04:38.205716 [error] [MainThread]: Encountered an error:
"~1.3" is not a valid semantic version.
[0m06:04:38.209270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f2f3810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ee5c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f482610>]}
[0m06:04:38.209680 [debug] [MainThread]: Flushing usage events
[0m06:06:53.494503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e423210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ff48bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea5c350>]}


============================== 06:06:53.503531 | 406ed0ae-2db7-473c-9f46-9679097c8944 ==============================
[0m06:06:53.503531 [info ] [MainThread]: Running with dbt=1.7.8
[0m06:06:53.503851 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'introspect': 'True', 'use_colors': 'True', 'write_json': 'True', 'static_parser': 'True', 'warn_error': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'profiles_dir': '/dbt', 'log_path': '/dbt/logs', 'debug': 'False', 'partial_parse': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'quiet': 'False', 'cache_selected_only': 'False'}
[0m06:06:53.538817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '406ed0ae-2db7-473c-9f46-9679097c8944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e42ab50>]}
[0m06:06:53.540346 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-blbbxlxp'
[0m06:06:53.540510 [error] [MainThread]: Encountered an error:
"~1.4" is not a valid semantic version.
[0m06:06:53.541216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e4292d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e893a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e761ed0>]}
[0m06:06:53.541440 [debug] [MainThread]: Flushing usage events
[0m06:07:40.169089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79c202d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79af2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79779110>]}


============================== 06:07:40.173416 | 2ac877db-38dd-4d5a-ac9f-eb51ab66089a ==============================
[0m06:07:40.173416 [info ] [MainThread]: Running with dbt=1.7.8
[0m06:07:40.173765 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'quiet': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'log_format': 'default', 'use_experimental_parser': 'False', 'introspect': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'use_colors': 'True', 'write_json': 'True', 'partial_parse': 'True', 'debug': 'False', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_path': '/dbt/logs', 'warn_error': 'None'}
[0m06:07:40.211846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ac877db-38dd-4d5a-ac9f-eb51ab66089a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7981df90>]}
[0m06:07:40.214660 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-p0o0ncf6'
[0m06:07:40.215112 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:07:40.574943 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:07:40.576783 [error] [MainThread]: Encountered an error:
Package dbt-labs/dbt-utils was not found in the package index
[0m06:07:40.579182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79797b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79a94950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ab11810>]}
[0m06:07:40.579651 [debug] [MainThread]: Flushing usage events
[0m06:09:02.828080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f83f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9714c2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96e30290>]}


============================== 06:09:02.842852 | a3d6b334-01b5-48dd-9d12-e3d9f882271b ==============================
[0m06:09:02.842852 [info ] [MainThread]: Running with dbt=1.7.8
[0m06:09:02.843452 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'quiet': 'False', 'printer_width': '80', 'no_print': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'version_check': 'True', 'debug': 'False', 'profiles_dir': '/dbt', 'target_path': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'warn_error': 'None', 'write_json': 'True', 'log_path': '/dbt/logs', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'log_cache_events': 'False'}
[0m06:09:02.900705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3d6b334-01b5-48dd-9d12-e3d9f882271b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff969a1110>]}
[0m06:09:02.902751 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vzj04gu2'
[0m06:09:02.903127 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:09:03.020264 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:09:03.021561 [error] [MainThread]: Encountered an error:
Package dbt-labs/dbt-utils was not found in the package index
[0m06:09:03.023372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c96810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9695ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f5d150>]}
[0m06:09:03.024087 [debug] [MainThread]: Flushing usage events
[0m06:10:34.234839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f95290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89f95b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a0f02d0>]}


============================== 06:10:34.271231 | 43e1e105-d217-40cd-82e7-017151e282ec ==============================
[0m06:10:34.271231 [info ] [MainThread]: Running with dbt=1.7.8
[0m06:10:34.271529 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'write_json': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'introspect': 'True', 'quiet': 'False', 'target_path': 'None', 'version_check': 'True', 'no_print': 'None', 'log_path': '/dbt/logs', 'static_parser': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/dbt', 'use_colors': 'True', 'partial_parse': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt debug', 'fail_fast': 'False'}
[0m06:10:34.271838 [info ] [MainThread]: dbt version: 1.7.8
[0m06:10:34.272079 [info ] [MainThread]: python version: 3.11.13
[0m06:10:34.272283 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m06:10:34.272534 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m06:10:34.276076 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'POSTGRES_USER'
[0m06:10:34.276643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a259950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ca1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a103a10>]}
[0m06:10:34.276851 [debug] [MainThread]: Flushing usage events
[0m06:16:31.980351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2432bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2aaff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb275b550>]}


============================== 06:16:31.993446 | 63815430-2d91-4e1f-84dc-75c767b74873 ==============================
[0m06:16:31.993446 [info ] [MainThread]: Running with dbt=1.7.8
[0m06:16:31.993847 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error': 'None', 'static_parser': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'write_json': 'True', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'fail_fast': 'False', 'log_path': '/dbt/logs', 'printer_width': '80', 'no_print': 'None', 'invocation_command': 'dbt deps', 'log_cache_events': 'False', 'profiles_dir': '/dbt', 'version_check': 'True', 'debug': 'False', 'use_experimental_parser': 'False'}
[0m06:16:32.018906 [error] [MainThread]: Encountered an error:
object of type 'NoneType' has no len()
[0m06:16:32.020678 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 152, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 185, in wrapper
    project = load_project(
              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/config/runtime.py", line 50, in load_project
    project = Project.from_project_root(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/config/project.py", line 743, in from_project_root
    return partial.render(renderer)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/config/project.py", line 330, in render
    return self.create_project(rendered)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/config/project.py", line 473, in create_project
    packages: PackageConfig = package_config_from_data(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/config/project.py", line 141, in package_config_from_data
    for i in range(0, len(packages_data.get("packages", []))):
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object of type 'NoneType' has no len()

[0m06:16:32.021648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb27bf310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb246d650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a31410>]}
[0m06:16:32.021889 [debug] [MainThread]: Flushing usage events
[0m06:22:44.359746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940c3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940c3390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93be3890>]}


============================== 06:22:44.372850 | 51e0dde1-fa49-4e69-a02f-e86688da4c2c ==============================
[0m06:22:44.372850 [info ] [MainThread]: Running with dbt=1.7.8
[0m06:22:44.373229 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'printer_width': '80', 'target_path': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/app/services/transform/logs', 'log_cache_events': 'False', 'warn_error': 'None', 'introspect': 'True', 'log_format': 'default', 'use_colors': 'True', 'write_json': 'True', 'fail_fast': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt deps', 'profiles_dir': '/app/services/transform', 'indirect_selection': 'eager', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False'}
[0m06:22:44.404178 [error] [MainThread]: Encountered an error:
object of type 'NoneType' has no len()
[0m06:22:44.406949 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 152, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 185, in wrapper
    project = load_project(
              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/config/runtime.py", line 50, in load_project
    project = Project.from_project_root(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/config/project.py", line 743, in from_project_root
    return partial.render(renderer)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/config/project.py", line 330, in render
    return self.create_project(rendered)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/config/project.py", line 473, in create_project
    packages: PackageConfig = package_config_from_data(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/config/project.py", line 141, in package_config_from_data
    for i in range(0, len(packages_data.get("packages", []))):
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: object of type 'NoneType' has no len()

[0m06:22:44.408316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a3bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff941e9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94095c50>]}
[0m06:22:44.408568 [debug] [MainThread]: Flushing usage events
[0m06:23:03.553672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a1b2bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d42d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a33b810>]}


============================== 06:23:03.561602 | 1ec0e55a-3920-4cc2-9676-5b0cc4e54603 ==============================
[0m06:23:03.561602 [info ] [MainThread]: Running with dbt=1.7.8
[0m06:23:03.562596 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/app/services/transform', 'log_format': 'default', 'indirect_selection': 'eager', 'warn_error': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt deps', 'log_cache_events': 'False', 'printer_width': '80', 'no_print': 'None', 'use_colors': 'True', 'log_path': '/app/services/transform/logs', 'partial_parse': 'True', 'quiet': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'target_path': 'None'}
[0m06:23:03.700110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ec0e55a-3920-4cc2-9676-5b0cc4e54603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a08c590>]}
[0m06:23:03.711671 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4v78xutk'
[0m06:23:03.712352 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:23:03.919881 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:23:03.920945 [error] [MainThread]: Encountered an error:
Package dbt-labs/dbt-utils was not found in the package index
[0m06:23:03.922423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d9b510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a08c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a32c890>]}
[0m06:23:03.922725 [debug] [MainThread]: Flushing usage events
[0m06:24:26.459429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90cefa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b16750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b3f410>]}


============================== 06:24:26.462125 | ecde0a93-c67d-44a1-a51e-105dbca46cda ==============================
[0m06:24:26.462125 [info ] [MainThread]: Running with dbt=1.7.8
[0m06:24:26.462446 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'introspect': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'log_path': '/app/services/transform/logs', 'quiet': 'False', 'use_colors': 'True', 'no_print': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'printer_width': '80', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/app/services/transform'}
[0m06:24:26.521944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecde0a93-c67d-44a1-a51e-105dbca46cda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91103110>]}
[0m06:24:26.552540 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-m56r__bp'
[0m06:24:26.556155 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:24:26.750236 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:24:26.751587 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m06:24:26.806727 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m06:24:26.808953 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m06:24:26.853738 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m06:24:26.865955 [info ] [MainThread]: Updating lock file in file path: /app/services/transform/package-lock.yml
[0m06:24:26.879594 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7w0f1haa'
[0m06:24:26.882521 [info ] [MainThread]: Installing dbt-labs/codegen
[0m06:24:27.282950 [info ] [MainThread]: Installed from version 0.10.0
[0m06:24:27.283998 [info ] [MainThread]: Updated version available: 0.13.1
[0m06:24:27.284847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ecde0a93-c67d-44a1-a51e-105dbca46cda', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff960f4950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff916ef4d0>]}
[0m06:24:27.285501 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m06:24:27.886826 [info ] [MainThread]: Installed from version 1.3.0
[0m06:24:27.888288 [info ] [MainThread]: Up to date!
[0m06:24:27.889848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ecde0a93-c67d-44a1-a51e-105dbca46cda', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff912eed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff960f4950>]}
[0m06:24:27.893402 [info ] [MainThread]: 
[0m06:24:27.894604 [info ] [MainThread]: Updates available for packages: ['dbt-labs/codegen']                 
Update your versions in packages.yml, then run dbt deps
[0m06:24:27.899192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90f7a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90f7a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90a0a910>]}
[0m06:24:27.899744 [debug] [MainThread]: Flushing usage events
[0m06:27:13.998100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1011410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0ff7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0e96cd0>]}


============================== 06:27:14.010380 | ab355951-0294-4170-b44d-2c145a806030 ==============================
[0m06:27:14.010380 [info ] [MainThread]: Running with dbt=1.7.8
[0m06:27:14.010798 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'fail_fast': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'partial_parse': 'True', 'no_print': 'None', 'introspect': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_format': 'default', 'profiles_dir': '/app/services/transform', 'quiet': 'False', 'static_parser': 'True', 'log_path': '/app/services/transform/logs', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None'}
[0m06:27:14.052248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab355951-0294-4170-b44d-2c145a806030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0bb4590>]}
[0m06:27:14.055089 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-m9qycgcj'
[0m06:27:14.055376 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m06:27:14.179911 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m06:27:14.180837 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m06:27:14.482694 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m06:27:14.488422 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils.json
[0m06:27:14.992251 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/spark_utils.json 200
[0m06:27:14.997911 [error] [MainThread]: Encountered an error:
Could not find a matching compatible version for package dbt-labs/spark_utils
  Requested range: =0.4.0, =0.4.0
  Compatible versions: ['0.1.0', '0.2.0', '0.2.1', '0.2.2', '0.2.3', '0.3.0']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'
[0m06:27:15.006169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0b69350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb11831d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1180890>]}
[0m06:27:15.007688 [debug] [MainThread]: Flushing usage events
[0m02:50:54.409673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff840b29d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83ed9450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84041690>]}


============================== 02:50:54.424596 | cd7aaa67-274a-47b1-af90-c6063f063580 ==============================
[0m02:50:54.424596 [info ] [MainThread]: Running with dbt=1.7.8
[0m02:50:54.425079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/services/transform/logs', 'profiles_dir': '/app/services/transform', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m02:50:54.471922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd7aaa67-274a-47b1-af90-c6063f063580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b07bd0>]}
[0m02:50:54.474035 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r8nb_qpo'
[0m02:50:54.474333 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:50:54.616762 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:50:54.617800 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m02:50:54.655987 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m02:50:54.658186 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:50:54.695773 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:50:54.704126 [info ] [MainThread]: Updating lock file in file path: /app/services/transform/package-lock.yml
[0m02:50:54.778381 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-m_o4oi1b'
[0m02:50:54.781296 [info ] [MainThread]: Installing dbt-labs/codegen
[0m02:50:55.154911 [info ] [MainThread]: Installed from version 0.10.0
[0m02:50:55.155516 [info ] [MainThread]: Updated version available: 0.13.1
[0m02:50:55.156094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cd7aaa67-274a-47b1-af90-c6063f063580', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff840e65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84058b90>]}
[0m02:50:55.156562 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:50:55.656271 [info ] [MainThread]: Installed from version 1.1.1
[0m02:50:55.657220 [info ] [MainThread]: Updated version available: 1.3.0
[0m02:50:55.657900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cd7aaa67-274a-47b1-af90-c6063f063580', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83db1210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8392d6d0>]}
[0m02:50:55.658420 [info ] [MainThread]: 
[0m02:50:55.658702 [info ] [MainThread]: Updates available for packages: ['dbt-labs/codegen', 'dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m02:50:55.662402 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.277084, "process_user_time": 1.004317, "process_kernel_time": 1.027462, "process_mem_max_rss": "114648", "process_in_blocks": "73136", "process_out_blocks": "2300"}
[0m02:50:55.663123 [debug] [MainThread]: Command `dbt deps` succeeded at 02:50:55.663034 after 1.28 seconds
[0m02:50:55.664236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83a91790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83a91c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84032d10>]}
[0m02:50:55.664674 [debug] [MainThread]: Flushing usage events
[0m02:50:57.894388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec33550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae9c0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae96c910>]}


============================== 02:50:57.896147 | bc482b20-3313-4c5a-9bff-ac836f8ad6e8 ==============================
[0m02:50:57.896147 [info ] [MainThread]: Running with dbt=1.7.8
[0m02:50:57.896455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/app/services/transform', 'log_path': '/app/services/transform/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:50:57.896789 [info ] [MainThread]: dbt version: 1.7.8
[0m02:50:57.897102 [info ] [MainThread]: python version: 3.11.13
[0m02:50:57.897389 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m02:50:57.897723 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m02:50:58.015719 [info ] [MainThread]: Using profiles dir at /app/services/transform
[0m02:50:58.016486 [info ] [MainThread]: Using profiles.yml file at /app/services/transform/profiles.yml
[0m02:50:58.017200 [info ] [MainThread]: Using dbt_project.yml file at /app/services/transform/dbt_project.yml
[0m02:50:58.017736 [info ] [MainThread]: adapter type: postgres
[0m02:50:58.018105 [info ] [MainThread]: adapter version: 1.7.8
[0m02:50:58.052857 [info ] [MainThread]: Configuration:
[0m02:50:58.053364 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:50:58.053947 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:50:58.054135 [info ] [MainThread]: Required dependencies:
[0m02:50:58.054528 [debug] [MainThread]: Executing "git --help"
[0m02:50:58.057587 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m02:50:58.057888 [info ] [MainThread]: Connection:
[0m02:50:58.058290 [info ] [MainThread]:   host: postgres
[0m02:50:58.058791 [info ] [MainThread]:   port: 5432
[0m02:50:58.059052 [info ] [MainThread]:   user: postgres
[0m02:50:58.059301 [info ] [MainThread]:   database: contentdb
[0m02:50:58.059457 [info ] [MainThread]:   schema: public
[0m02:50:58.059724 [info ] [MainThread]:   connect_timeout: 10
[0m02:50:58.059894 [info ] [MainThread]:   role: None
[0m02:50:58.060174 [info ] [MainThread]:   search_path: None
[0m02:50:58.060384 [info ] [MainThread]:   keepalives_idle: 0
[0m02:50:58.060540 [info ] [MainThread]:   sslmode: None
[0m02:50:58.060705 [info ] [MainThread]:   sslcert: None
[0m02:50:58.060912 [info ] [MainThread]:   sslkey: None
[0m02:50:58.061095 [info ] [MainThread]:   sslrootcert: None
[0m02:50:58.061286 [info ] [MainThread]:   application_name: dbt
[0m02:50:58.061504 [info ] [MainThread]:   retries: 1
[0m02:50:58.061770 [info ] [MainThread]: Registered adapter: postgres=1.7.8
[0m02:50:58.062444 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m02:50:58.062617 [debug] [MainThread]: Using postgres connection "debug"
[0m02:50:58.062756 [debug] [MainThread]: On debug: select 1 as id
[0m02:50:58.062928 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:50:58.138819 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m02:50:58.139958 [debug] [MainThread]: On debug: Close
[0m02:50:58.140185 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:50:58.140423 [info ] [MainThread]: [31m1 check failed:[0m
[0m02:50:58.140914 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m02:50:58.145605 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.26977137, "process_user_time": 0.883865, "process_kernel_time": 0.213692, "process_mem_max_rss": "120152", "process_in_blocks": "15560", "process_out_blocks": "8", "command_success": false}
[0m02:50:58.146690 [debug] [MainThread]: Command `dbt debug` failed at 02:50:58.146587 after 0.27 seconds
[0m02:50:58.147081 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:50:58.147450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec459d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec45450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3df6290>]}
[0m02:50:58.148123 [debug] [MainThread]: Flushing usage events
[0m02:52:20.293564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f97950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff882bd710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88564c10>]}


============================== 02:52:20.318114 | 5538f7ab-2a9f-45c7-a6cf-d2d31db70d7b ==============================
[0m02:52:20.318114 [info ] [MainThread]: Running with dbt=1.7.8
[0m02:52:20.318538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/services/transform', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/app/services/transform/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:52:20.369315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5538f7ab-2a9f-45c7-a6cf-d2d31db70d7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87fff810>]}
[0m02:52:20.478591 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-d2lkfqno'
[0m02:52:20.479385 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:52:20.618667 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:52:20.619678 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m02:52:20.669694 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m02:52:20.671021 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:52:20.715158 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:52:20.717781 [info ] [MainThread]: Installing dbt-labs/codegen
[0m02:52:21.104267 [info ] [MainThread]: Installed from version 0.10.0
[0m02:52:21.104684 [info ] [MainThread]: Updated version available: 0.13.1
[0m02:52:21.105280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5538f7ab-2a9f-45c7-a6cf-d2d31db70d7b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f98790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f48150>]}
[0m02:52:21.105704 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:52:21.721306 [info ] [MainThread]: Installed from version 1.1.1
[0m02:52:21.722235 [info ] [MainThread]: Updated version available: 1.3.0
[0m02:52:21.722758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5538f7ab-2a9f-45c7-a6cf-d2d31db70d7b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88280210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87e96b10>]}
[0m02:52:21.723261 [info ] [MainThread]: 
[0m02:52:21.723611 [info ] [MainThread]: Updates available for packages: ['dbt-labs/codegen', 'dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m02:52:21.730429 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.4725902, "process_user_time": 0.934648, "process_kernel_time": 0.353204, "process_mem_max_rss": "114676", "process_out_blocks": "2300", "process_in_blocks": "0"}
[0m02:52:21.731637 [debug] [MainThread]: Command `dbt deps` succeeded at 02:52:21.731395 after 1.47 seconds
[0m02:52:21.732628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f98590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f9b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88534e50>]}
[0m02:52:21.733014 [debug] [MainThread]: Flushing usage events
[0m02:52:24.024602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1224c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb16e8dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1362090>]}


============================== 02:52:24.026798 | ca0e648d-110a-4d5b-b81e-a02aca8b82cb ==============================
[0m02:52:24.026798 [info ] [MainThread]: Running with dbt=1.7.8
[0m02:52:24.027530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/app/services/transform/logs', 'profiles_dir': '/app/services/transform', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m02:52:24.027971 [info ] [MainThread]: dbt version: 1.7.8
[0m02:52:24.028215 [info ] [MainThread]: python version: 3.11.13
[0m02:52:24.028593 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m02:52:24.028903 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m02:52:24.102221 [info ] [MainThread]: Using profiles dir at /app/services/transform
[0m02:52:24.102982 [info ] [MainThread]: Using profiles.yml file at /app/services/transform/profiles.yml
[0m02:52:24.103385 [info ] [MainThread]: Using dbt_project.yml file at /app/services/transform/dbt_project.yml
[0m02:52:24.103830 [info ] [MainThread]: adapter type: postgres
[0m02:52:24.104029 [info ] [MainThread]: adapter version: 1.7.8
[0m02:52:24.145803 [info ] [MainThread]: Configuration:
[0m02:52:24.146373 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:52:24.146692 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:52:24.147081 [info ] [MainThread]: Required dependencies:
[0m02:52:24.147403 [debug] [MainThread]: Executing "git --help"
[0m02:52:24.151046 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:52:24.151362 [debug] [MainThread]: STDERR: "b''"
[0m02:52:24.151585 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:52:24.151806 [info ] [MainThread]: Connection:
[0m02:52:24.152262 [info ] [MainThread]:   host: postgres
[0m02:52:24.152513 [info ] [MainThread]:   port: 5432
[0m02:52:24.152709 [info ] [MainThread]:   user: postgres
[0m02:52:24.152923 [info ] [MainThread]:   database: contentdb
[0m02:52:24.153249 [info ] [MainThread]:   schema: public
[0m02:52:24.153442 [info ] [MainThread]:   connect_timeout: 10
[0m02:52:24.153669 [info ] [MainThread]:   role: None
[0m02:52:24.153843 [info ] [MainThread]:   search_path: None
[0m02:52:24.154006 [info ] [MainThread]:   keepalives_idle: 0
[0m02:52:24.154305 [info ] [MainThread]:   sslmode: None
[0m02:52:24.154526 [info ] [MainThread]:   sslcert: None
[0m02:52:24.154753 [info ] [MainThread]:   sslkey: None
[0m02:52:24.154941 [info ] [MainThread]:   sslrootcert: None
[0m02:52:24.155259 [info ] [MainThread]:   application_name: dbt
[0m02:52:24.155465 [info ] [MainThread]:   retries: 1
[0m02:52:24.155741 [info ] [MainThread]: Registered adapter: postgres=1.7.8
[0m02:52:24.156386 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m02:52:24.156570 [debug] [MainThread]: Using postgres connection "debug"
[0m02:52:24.156698 [debug] [MainThread]: On debug: select 1 as id
[0m02:52:24.156815 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:52:24.224873 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m02:52:24.225724 [debug] [MainThread]: On debug: Close
[0m02:52:24.225957 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:52:24.226218 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:52:24.227165 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.23771937, "process_user_time": 0.995408, "process_kernel_time": 0.15534, "process_mem_max_rss": "120640", "process_out_blocks": "12", "process_in_blocks": "0"}
[0m02:52:24.227450 [debug] [MainThread]: Command `dbt debug` succeeded at 02:52:24.227377 after 0.24 seconds
[0m02:52:24.227617 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:52:24.227811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb14ef050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb109a5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1357250>]}
[0m02:52:24.228043 [debug] [MainThread]: Flushing usage events
[0m02:52:26.485277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae57db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae9dd1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae997d90>]}


============================== 02:52:26.486603 | 4fc81bfb-618f-410f-892d-821b87a21832 ==============================
[0m02:52:26.486603 [info ] [MainThread]: Running with dbt=1.7.8
[0m02:52:26.486944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/services/transform', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/app/services/transform/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select stg_youtube+', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:52:26.552881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fc81bfb-618f-410f-892d-821b87a21832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae9ddc50>]}
[0m02:52:26.587264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fc81bfb-618f-410f-892d-821b87a21832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec561d0>]}
[0m02:52:26.587806 [info ] [MainThread]: Registered adapter: postgres=1.7.8
[0m02:52:26.596699 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m02:52:26.597594 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:52:26.597859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4fc81bfb-618f-410f-892d-821b87a21832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad9937d0>]}
[0m02:52:27.163575 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- snapshots.content_trend_advisor
[0m02:52:27.166561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fc81bfb-618f-410f-892d-821b87a21832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb1ecd0>]}
[0m02:52:27.174523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fc81bfb-618f-410f-892d-821b87a21832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb86750>]}
[0m02:52:27.174881 [info ] [MainThread]: Found 2 models, 12 tests, 1 source, 0 exposures, 0 metrics, 529 macros, 0 groups, 0 semantic models
[0m02:52:27.177329 [info ] [MainThread]: 
[0m02:52:27.177919 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:52:27.179021 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contentdb'
[0m02:52:27.184674 [debug] [ThreadPool]: Using postgres connection "list_contentdb"
[0m02:52:27.184989 [debug] [ThreadPool]: On list_contentdb: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb"} */

    select distinct nspname from pg_namespace
  
[0m02:52:27.185196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:52:27.205087 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m02:52:27.206085 [debug] [ThreadPool]: On list_contentdb: Close
[0m02:52:27.208449 [debug] [ThreadPool]: Using postgres connection "list_contentdb"
[0m02:52:27.208940 [debug] [ThreadPool]: On list_contentdb: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb"} */

    select distinct nspname from pg_namespace
  
[0m02:52:27.209246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:52:27.216507 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m02:52:27.217301 [debug] [ThreadPool]: On list_contentdb: Close
[0m02:52:27.217892 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contentdb, now create_contentdb_public_staging)
[0m02:52:27.218588 [debug] [ThreadPool]: Creating schema "database: "contentdb"
schema: "public_staging"
"
[0m02:52:27.220922 [debug] [ThreadPool]: Using postgres connection "create_contentdb_public_staging"
[0m02:52:27.221094 [debug] [ThreadPool]: On create_contentdb_public_staging: BEGIN
[0m02:52:27.221222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:52:27.224268 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:52:27.224452 [debug] [ThreadPool]: Using postgres connection "create_contentdb_public_staging"
[0m02:52:27.224631 [debug] [ThreadPool]: On create_contentdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "create_contentdb_public_staging"} */
create schema if not exists "public_staging"
[0m02:52:27.228521 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m02:52:27.228908 [debug] [ThreadPool]: On create_contentdb_public_staging: COMMIT
[0m02:52:27.229055 [debug] [ThreadPool]: Using postgres connection "create_contentdb_public_staging"
[0m02:52:27.229168 [debug] [ThreadPool]: On create_contentdb_public_staging: COMMIT
[0m02:52:27.229971 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m02:52:27.230131 [debug] [ThreadPool]: On create_contentdb_public_staging: Close
[0m02:52:27.230673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_contentdb_public_staging, now create_contentdb_public_marts)
[0m02:52:27.230996 [debug] [ThreadPool]: Creating schema "database: "contentdb"
schema: "public_marts"
"
[0m02:52:27.231859 [debug] [ThreadPool]: Using postgres connection "create_contentdb_public_marts"
[0m02:52:27.231993 [debug] [ThreadPool]: On create_contentdb_public_marts: BEGIN
[0m02:52:27.232138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:52:27.236255 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:52:27.236730 [debug] [ThreadPool]: Using postgres connection "create_contentdb_public_marts"
[0m02:52:27.236895 [debug] [ThreadPool]: On create_contentdb_public_marts: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "create_contentdb_public_marts"} */
create schema if not exists "public_marts"
[0m02:52:27.237358 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m02:52:27.238024 [debug] [ThreadPool]: On create_contentdb_public_marts: COMMIT
[0m02:52:27.238484 [debug] [ThreadPool]: Using postgres connection "create_contentdb_public_marts"
[0m02:52:27.238628 [debug] [ThreadPool]: On create_contentdb_public_marts: COMMIT
[0m02:52:27.239110 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m02:52:27.239252 [debug] [ThreadPool]: On create_contentdb_public_marts: Close
[0m02:52:27.240325 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contentdb_public_staging'
[0m02:52:27.243160 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_staging"
[0m02:52:27.243407 [debug] [ThreadPool]: On list_contentdb_public_staging: BEGIN
[0m02:52:27.243536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:52:27.247777 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:52:27.248133 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_staging"
[0m02:52:27.248307 [debug] [ThreadPool]: On list_contentdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb_public_staging"} */
select
      'contentdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'contentdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'contentdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m02:52:27.257610 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m02:52:27.258183 [debug] [ThreadPool]: On list_contentdb_public_staging: ROLLBACK
[0m02:52:27.258394 [debug] [ThreadPool]: On list_contentdb_public_staging: Close
[0m02:52:27.258835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contentdb_public_staging, now list_contentdb_public_marts)
[0m02:52:27.259836 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_marts"
[0m02:52:27.259978 [debug] [ThreadPool]: On list_contentdb_public_marts: BEGIN
[0m02:52:27.260139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:52:27.266536 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:52:27.266986 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_marts"
[0m02:52:27.267281 [debug] [ThreadPool]: On list_contentdb_public_marts: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb_public_marts"} */
select
      'contentdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'contentdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'contentdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m02:52:27.269256 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m02:52:27.269906 [debug] [ThreadPool]: On list_contentdb_public_marts: ROLLBACK
[0m02:52:27.270136 [debug] [ThreadPool]: On list_contentdb_public_marts: Close
[0m02:52:27.273271 [debug] [MainThread]: Using postgres connection "master"
[0m02:52:27.273639 [debug] [MainThread]: On master: BEGIN
[0m02:52:27.273815 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:52:27.278718 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:52:27.278988 [debug] [MainThread]: Using postgres connection "master"
[0m02:52:27.279191 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:52:27.300671 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m02:52:27.301475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fc81bfb-618f-410f-892d-821b87a21832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac71d350>]}
[0m02:52:27.301775 [debug] [MainThread]: On master: ROLLBACK
[0m02:52:27.302032 [debug] [MainThread]: Using postgres connection "master"
[0m02:52:27.302230 [debug] [MainThread]: On master: BEGIN
[0m02:52:27.302642 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:52:27.302863 [debug] [MainThread]: On master: COMMIT
[0m02:52:27.303174 [debug] [MainThread]: Using postgres connection "master"
[0m02:52:27.303305 [debug] [MainThread]: On master: COMMIT
[0m02:52:27.303508 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:52:27.303812 [debug] [MainThread]: On master: Close
[0m02:52:27.304203 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:52:27.304464 [info ] [MainThread]: 
[0m02:52:27.309890 [debug] [Thread-1 (]: Began running node model.content_trend_advisor.stg_youtube
[0m02:52:27.310266 [info ] [Thread-1 (]: 1 of 11 START sql view model public_staging.stg_youtube ........................ [RUN]
[0m02:52:27.310685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contentdb_public_marts, now model.content_trend_advisor.stg_youtube)
[0m02:52:27.310854 [debug] [Thread-1 (]: Began compiling node model.content_trend_advisor.stg_youtube
[0m02:52:27.314479 [debug] [Thread-1 (]: Writing injected SQL for node "model.content_trend_advisor.stg_youtube"
[0m02:52:27.316460 [debug] [Thread-1 (]: Timing info for model.content_trend_advisor.stg_youtube (compile): 02:52:27.310959 => 02:52:27.316187
[0m02:52:27.316654 [debug] [Thread-1 (]: Began executing node model.content_trend_advisor.stg_youtube
[0m02:52:27.332322 [debug] [Thread-1 (]: Writing runtime sql for node "model.content_trend_advisor.stg_youtube"
[0m02:52:27.333892 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:52:27.334103 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: BEGIN
[0m02:52:27.334269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:52:27.337089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:52:27.337272 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:52:27.337497 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */

  create view "contentdb"."public_staging"."stg_youtube__dbt_tmp"
    
    
  as (
    WITH src AS (
  SELECT 
    external_id AS video_id,
    fetched_at,
    payload
  FROM "contentdb"."public"."raw_content"
  WHERE source = 'youtube'
), 

clean AS (
  SELECT
    video_id,

    /* Titles and descriptions: prefer localized when present */
    COALESCE(payload->'snippet'->'localized'->>'title', payload->'snippet'->>'title') AS title,
    LEFT(COALESCE(payload->'snippet'->'localized'->>'description', payload->'snippet'->>'description', ''), 1000) AS description,

    /* Channel and timing info */
    payload->'snippet'->>'channelId' AS channel_id,
    payload->'snippet'->>'channelTitle' AS channel_title,
    (payload->'snippet'->>'publishedAt')::timestamptz AS published_at,

    /* Category and language (note: YouTube uses camelCase keys) */
    payload->'snippet'->>'categoryId' AS category_id,
    payload->'snippet'->>'defaultAudioLanguage' AS default_audio_language,

    /* Core metrics from statistics (->> needs quoted keys) */
    COALESCE((payload->'statistics'->>'viewCount')::bigint, 0) AS view_count,
    COALESCE((payload->'statistics'->>'likeCount')::bigint, 0) AS like_count,
    COALESCE((payload->'statistics'->>'commentCount')::bigint, 0) AS comment_count,

    /* Duration as seconds from ISO8601 duration */
    CASE
      WHEN payload->'contentDetails'->>'duration' IS NOT NULL
        THEN 
  (
    COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[1], '0')::int * 3600
  + COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[2], '0')::int * 60
  + COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[3], '0')::int
  )

      ELSE NULL
    END AS duration_seconds,

    /* Tags, topics, categories */
    
  COALESCE(
    ARRAY(
      SELECT jsonb_array_elements_text(payload->'snippet'->'tags')
    ),
    ARRAY[]::text[]
  )
 AS tags,

    /* _filter_metadata.detected_topics is an array; use -> (JSONB) not ->> (text) */
    COALESCE(
      ARRAY(SELECT jsonb_array_elements_text(payload->'_filter_metadata'->'detected_topics')),
      ARRAY[]::text[]
    ) AS detected_topics,

    payload->'_filter_metadata'->>'detected_language' AS detected_language,
    payload->'_filter_metadata'->>'category_name' AS category_name,

    /* topicDetails.topicCategories is an array of URLs */
    COALESCE(
      ARRAY(SELECT jsonb_array_elements_text(payload->'topicDetails'->'topicCategories')),
      ARRAY[]::text[]
    ) AS topic_categories,

    /* Derived metrics */
    
  CASE
    WHEN view_count::float > 0
      THEN ROUND(((COALESCE(like_count, 0) + COALESCE(comment_count, 0))::float / view_count::float) * 100, 2)
    ELSE 0
  END
 AS engagement_rate,
    DATE_TRUNC('day', fetched_at) AS fetched_date,
    EXTRACT(DAY FROM (NOW() - (payload->'snippet'->>'publishedAt')::timestamptz)) AS days_since_published

  FROM src
)

SELECT * FROM clean;
  );
[0m02:52:27.338135 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 90: SELECT * FROM clean;
                            ^

[0m02:52:27.338315 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: ROLLBACK
[0m02:52:27.338565 [debug] [Thread-1 (]: Timing info for model.content_trend_advisor.stg_youtube (execute): 02:52:27.316759 => 02:52:27.338487
[0m02:52:27.338723 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: Close
[0m02:52:27.340835 [debug] [Thread-1 (]: Database Error in model stg_youtube (models/staging/stg_youtube.sql)
  syntax error at or near ";"
  LINE 90: SELECT * FROM clean;
                              ^
  compiled Code at target/run/content_trend_advisor/models/staging/stg_youtube.sql
[0m02:52:27.341066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fc81bfb-618f-410f-892d-821b87a21832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac7b62d0>]}
[0m02:52:27.341357 [error] [Thread-1 (]: 1 of 11 ERROR creating sql view model public_staging.stg_youtube ............... [[31mERROR[0m in 0.03s]
[0m02:52:27.341691 [debug] [Thread-1 (]: Finished running node model.content_trend_advisor.stg_youtube
[0m02:52:27.342324 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.accepted_range_stg_youtube_engagement_rate__100__0.03b5eb9837
[0m02:52:27.342523 [info ] [Thread-1 (]: 2 of 11 SKIP test accepted_range_stg_youtube_engagement_rate__100__0 ........... [[33mSKIP[0m]
[0m02:52:27.342743 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.accepted_range_stg_youtube_engagement_rate__100__0.03b5eb9837
[0m02:52:27.342935 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m02:52:27.343126 [info ] [Thread-1 (]: 3 of 11 SKIP test not_null_stg_youtube_published_at ............................ [[33mSKIP[0m]
[0m02:52:27.343331 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m02:52:27.343492 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m02:52:27.343663 [info ] [Thread-1 (]: 4 of 11 SKIP test not_null_stg_youtube_video_id ................................ [[33mSKIP[0m]
[0m02:52:27.343891 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m02:52:27.344116 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m02:52:27.344303 [info ] [Thread-1 (]: 5 of 11 SKIP test not_null_stg_youtube_view_count .............................. [[33mSKIP[0m]
[0m02:52:27.344626 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m02:52:27.344839 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m02:52:27.345088 [info ] [Thread-1 (]: 6 of 11 SKIP test unique_stg_youtube_video_id .................................. [[33mSKIP[0m]
[0m02:52:27.345328 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m02:52:27.345714 [debug] [Thread-1 (]: Began running node model.content_trend_advisor.features_content_engagement
[0m02:52:27.345893 [info ] [Thread-1 (]: 7 of 11 SKIP relation public_marts.features_content_engagement ................. [[33mSKIP[0m]
[0m02:52:27.346149 [debug] [Thread-1 (]: Finished running node model.content_trend_advisor.features_content_engagement
[0m02:52:27.346510 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341
[0m02:52:27.346683 [info ] [Thread-1 (]: 8 of 11 SKIP test accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low  [[33mSKIP[0m]
[0m02:52:27.346910 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341
[0m02:52:27.347202 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a
[0m02:52:27.347386 [info ] [Thread-1 (]: 9 of 11 SKIP test not_null_features_content_engagement_is_trending ............. [[33mSKIP[0m]
[0m02:52:27.347618 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a
[0m02:52:27.347802 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7
[0m02:52:27.347978 [info ] [Thread-1 (]: 10 of 11 SKIP test not_null_features_content_engagement_video_id ............... [[33mSKIP[0m]
[0m02:52:27.348202 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7
[0m02:52:27.348377 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221
[0m02:52:27.348533 [info ] [Thread-1 (]: 11 of 11 SKIP test unique_features_content_engagement_video_id ................. [[33mSKIP[0m]
[0m02:52:27.348742 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221
[0m02:52:27.349403 [debug] [MainThread]: Using postgres connection "master"
[0m02:52:27.349576 [debug] [MainThread]: On master: BEGIN
[0m02:52:27.349698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:52:27.352114 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:52:27.352253 [debug] [MainThread]: On master: COMMIT
[0m02:52:27.352371 [debug] [MainThread]: Using postgres connection "master"
[0m02:52:27.352478 [debug] [MainThread]: On master: COMMIT
[0m02:52:27.352627 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:52:27.352743 [debug] [MainThread]: On master: Close
[0m02:52:27.353008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:52:27.353126 [debug] [MainThread]: Connection 'create_contentdb_public_marts' was properly closed.
[0m02:52:27.353236 [debug] [MainThread]: Connection 'model.content_trend_advisor.stg_youtube' was properly closed.
[0m02:52:27.353400 [info ] [MainThread]: 
[0m02:52:27.353589 [info ] [MainThread]: Finished running 1 view model, 9 tests, 1 table model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m02:52:27.354006 [debug] [MainThread]: Command end result
[0m02:52:27.359243 [info ] [MainThread]: 
[0m02:52:27.359429 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:52:27.359618 [info ] [MainThread]: 
[0m02:52:27.359807 [error] [MainThread]:   Database Error in model stg_youtube (models/staging/stg_youtube.sql)
  syntax error at or near ";"
  LINE 90: SELECT * FROM clean;
                              ^
  compiled Code at target/run/content_trend_advisor/models/staging/stg_youtube.sql
[0m02:52:27.359971 [info ] [MainThread]: 
[0m02:52:27.360188 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=10 TOTAL=11
[0m02:52:27.360779 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.89096, "process_user_time": 1.48182, "process_kernel_time": 0.110433, "process_mem_max_rss": "137424", "process_in_blocks": "64", "process_out_blocks": "3551", "command_success": false}
[0m02:52:27.361012 [debug] [MainThread]: Command `dbt build` failed at 02:52:27.360957 after 0.89 seconds
[0m02:52:27.361203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb36050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec56190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb5c750>]}
[0m02:52:27.361364 [debug] [MainThread]: Flushing usage events
[0m02:53:27.078175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e74f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e5c9e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e7ea190>]}


============================== 02:53:27.080194 | 6ddea938-6c94-412b-af3a-a993189d7eb6 ==============================
[0m02:53:27.080194 [info ] [MainThread]: Running with dbt=1.7.8
[0m02:53:27.080582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/app/services/transform', 'log_path': '/app/services/transform/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select stg_youtube+', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:53:27.158707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ddea938-6c94-412b-af3a-a993189d7eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d67d190>]}
[0m02:53:27.190940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ddea938-6c94-412b-af3a-a993189d7eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d647ad0>]}
[0m02:53:27.191466 [info ] [MainThread]: Registered adapter: postgres=1.7.8
[0m02:53:27.204343 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m02:53:27.268754 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m02:53:27.269185 [debug] [MainThread]: Partial parsing: updated file: content_trend_advisor://models/staging/stg_youtube.sql
[0m02:53:27.269432 [debug] [MainThread]: Partial parsing: updated file: content_trend_advisor://models/marts/features_content_engagement.sql
[0m02:53:27.391788 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- snapshots.content_trend_advisor
[0m02:53:27.394140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ddea938-6c94-412b-af3a-a993189d7eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cf82890>]}
[0m02:53:27.410164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ddea938-6c94-412b-af3a-a993189d7eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e19fb10>]}
[0m02:53:27.410628 [info ] [MainThread]: Found 12 tests, 2 models, 1 source, 0 exposures, 0 metrics, 529 macros, 0 groups, 0 semantic models
[0m02:53:27.412341 [info ] [MainThread]: 
[0m02:53:27.413022 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:53:27.414159 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contentdb'
[0m02:53:27.419207 [debug] [ThreadPool]: Using postgres connection "list_contentdb"
[0m02:53:27.419461 [debug] [ThreadPool]: On list_contentdb: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb"} */

    select distinct nspname from pg_namespace
  
[0m02:53:27.419604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:53:27.450864 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:53:27.452006 [debug] [ThreadPool]: On list_contentdb: Close
[0m02:53:27.453676 [debug] [ThreadPool]: Using postgres connection "list_contentdb"
[0m02:53:27.453892 [debug] [ThreadPool]: On list_contentdb: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb"} */

    select distinct nspname from pg_namespace
  
[0m02:53:27.454045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:53:27.462889 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:53:27.463860 [debug] [ThreadPool]: On list_contentdb: Close
[0m02:53:27.465996 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contentdb_public_staging'
[0m02:53:27.469886 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_staging"
[0m02:53:27.470242 [debug] [ThreadPool]: On list_contentdb_public_staging: BEGIN
[0m02:53:27.470401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:53:27.474816 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:53:27.475142 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_staging"
[0m02:53:27.475320 [debug] [ThreadPool]: On list_contentdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb_public_staging"} */
select
      'contentdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'contentdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'contentdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m02:53:27.477042 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m02:53:27.477600 [debug] [ThreadPool]: On list_contentdb_public_staging: ROLLBACK
[0m02:53:27.477789 [debug] [ThreadPool]: On list_contentdb_public_staging: Close
[0m02:53:27.478266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contentdb_public_staging, now list_contentdb_public_marts)
[0m02:53:27.479219 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_marts"
[0m02:53:27.479370 [debug] [ThreadPool]: On list_contentdb_public_marts: BEGIN
[0m02:53:27.479499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:53:27.482136 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:53:27.482323 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_marts"
[0m02:53:27.482473 [debug] [ThreadPool]: On list_contentdb_public_marts: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb_public_marts"} */
select
      'contentdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'contentdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'contentdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m02:53:27.483768 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m02:53:27.484330 [debug] [ThreadPool]: On list_contentdb_public_marts: ROLLBACK
[0m02:53:27.484516 [debug] [ThreadPool]: On list_contentdb_public_marts: Close
[0m02:53:27.487224 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:27.488053 [debug] [MainThread]: On master: BEGIN
[0m02:53:27.488214 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:53:27.493270 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:53:27.493553 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:27.493745 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:53:27.498788 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m02:53:27.499673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ddea938-6c94-412b-af3a-a993189d7eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cff3d50>]}
[0m02:53:27.500039 [debug] [MainThread]: On master: ROLLBACK
[0m02:53:27.500402 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:27.500567 [debug] [MainThread]: On master: BEGIN
[0m02:53:27.500857 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:53:27.501029 [debug] [MainThread]: On master: COMMIT
[0m02:53:27.501206 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:27.501362 [debug] [MainThread]: On master: COMMIT
[0m02:53:27.501573 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:53:27.501781 [debug] [MainThread]: On master: Close
[0m02:53:27.502241 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:53:27.502466 [info ] [MainThread]: 
[0m02:53:27.505245 [debug] [Thread-1 (]: Began running node model.content_trend_advisor.stg_youtube
[0m02:53:27.505563 [info ] [Thread-1 (]: 1 of 11 START sql view model public_staging.stg_youtube ........................ [RUN]
[0m02:53:27.505961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contentdb_public_marts, now model.content_trend_advisor.stg_youtube)
[0m02:53:27.506149 [debug] [Thread-1 (]: Began compiling node model.content_trend_advisor.stg_youtube
[0m02:53:27.510451 [debug] [Thread-1 (]: Writing injected SQL for node "model.content_trend_advisor.stg_youtube"
[0m02:53:27.511055 [debug] [Thread-1 (]: Timing info for model.content_trend_advisor.stg_youtube (compile): 02:53:27.506278 => 02:53:27.510965
[0m02:53:27.511228 [debug] [Thread-1 (]: Began executing node model.content_trend_advisor.stg_youtube
[0m02:53:27.526026 [debug] [Thread-1 (]: Writing runtime sql for node "model.content_trend_advisor.stg_youtube"
[0m02:53:27.526614 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:53:27.526764 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: BEGIN
[0m02:53:27.526904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:53:27.530243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:53:27.530429 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:53:27.530653 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */

  create view "contentdb"."public_staging"."stg_youtube__dbt_tmp"
    
    
  as (
    WITH src AS (
  SELECT 
    external_id AS video_id,
    fetched_at,
    payload
  FROM "contentdb"."public"."raw_content"
  WHERE source = 'youtube'
), 

clean AS (
  SELECT
    video_id,

    /* Titles and descriptions: prefer localized when present */
    COALESCE(payload->'snippet'->'localized'->>'title', payload->'snippet'->>'title') AS title,
    LEFT(COALESCE(payload->'snippet'->'localized'->>'description', payload->'snippet'->>'description', ''), 1000) AS description,

    /* Channel and timing info */
    payload->'snippet'->>'channelId' AS channel_id,
    payload->'snippet'->>'channelTitle' AS channel_title,
    (payload->'snippet'->>'publishedAt')::timestamptz AS published_at,

    /* Category and language (note: YouTube uses camelCase keys) */
    payload->'snippet'->>'categoryId' AS category_id,
    payload->'snippet'->>'defaultAudioLanguage' AS default_audio_language,

    /* Core metrics from statistics (->> needs quoted keys) */
    COALESCE((payload->'statistics'->>'viewCount')::bigint, 0) AS view_count,
    COALESCE((payload->'statistics'->>'likeCount')::bigint, 0) AS like_count,
    COALESCE((payload->'statistics'->>'commentCount')::bigint, 0) AS comment_count,

    /* Duration as seconds from ISO8601 duration */
    CASE
      WHEN payload->'contentDetails'->>'duration' IS NOT NULL
        THEN 
  (
    COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[1], '0')::int * 3600
  + COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[2], '0')::int * 60
  + COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[3], '0')::int
  )

      ELSE NULL
    END AS duration_seconds,

    /* Tags, topics, categories */
    
  COALESCE(
    ARRAY(
      SELECT jsonb_array_elements_text(payload->'snippet'->'tags')
    ),
    ARRAY[]::text[]
  )
 AS tags,

    /* _filter_metadata.detected_topics is an array; use -> (JSONB) not ->> (text) */
    COALESCE(
      ARRAY(SELECT jsonb_array_elements_text(payload->'_filter_metadata'->'detected_topics')),
      ARRAY[]::text[]
    ) AS detected_topics,

    payload->'_filter_metadata'->>'detected_language' AS detected_language,
    payload->'_filter_metadata'->>'category_name' AS category_name,

    /* topicDetails.topicCategories is an array of URLs */
    COALESCE(
      ARRAY(SELECT jsonb_array_elements_text(payload->'topicDetails'->'topicCategories')),
      ARRAY[]::text[]
    ) AS topic_categories,

    /* Derived metrics */
    
  CASE
    WHEN view_count::float > 0
      THEN ROUND(((COALESCE(like_count, 0) + COALESCE(comment_count, 0))::float / view_count::float) * 100, 2)
    ELSE 0
  END
 AS engagement_rate,
    DATE_TRUNC('day', fetched_at) AS fetched_date,
    EXTRACT(DAY FROM (NOW() - (payload->'snippet'->>'publishedAt')::timestamptz)) AS days_since_published

  FROM src
)

SELECT * FROM clean
  );
[0m02:53:27.534679 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "view_count" does not exist
LINE 79:     WHEN view_count::float > 0
                  ^

[0m02:53:27.534918 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: ROLLBACK
[0m02:53:27.535308 [debug] [Thread-1 (]: Timing info for model.content_trend_advisor.stg_youtube (execute): 02:53:27.511330 => 02:53:27.535134
[0m02:53:27.535499 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: Close
[0m02:53:27.538383 [debug] [Thread-1 (]: Database Error in model stg_youtube (models/staging/stg_youtube.sql)
  column "view_count" does not exist
  LINE 79:     WHEN view_count::float > 0
                    ^
  compiled Code at target/run/content_trend_advisor/models/staging/stg_youtube.sql
[0m02:53:27.542215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ddea938-6c94-412b-af3a-a993189d7eb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cbbd350>]}
[0m02:53:27.542534 [error] [Thread-1 (]: 1 of 11 ERROR creating sql view model public_staging.stg_youtube ............... [[31mERROR[0m in 0.04s]
[0m02:53:27.542825 [debug] [Thread-1 (]: Finished running node model.content_trend_advisor.stg_youtube
[0m02:53:27.543586 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.accepted_range_stg_youtube_engagement_rate__100__0.03b5eb9837
[0m02:53:27.543773 [info ] [Thread-1 (]: 2 of 11 SKIP test accepted_range_stg_youtube_engagement_rate__100__0 ........... [[33mSKIP[0m]
[0m02:53:27.544013 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.accepted_range_stg_youtube_engagement_rate__100__0.03b5eb9837
[0m02:53:27.544216 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m02:53:27.544412 [info ] [Thread-1 (]: 3 of 11 SKIP test not_null_stg_youtube_published_at ............................ [[33mSKIP[0m]
[0m02:53:27.544634 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m02:53:27.544803 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m02:53:27.544969 [info ] [Thread-1 (]: 4 of 11 SKIP test not_null_stg_youtube_video_id ................................ [[33mSKIP[0m]
[0m02:53:27.545184 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m02:53:27.545351 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m02:53:27.545512 [info ] [Thread-1 (]: 5 of 11 SKIP test not_null_stg_youtube_view_count .............................. [[33mSKIP[0m]
[0m02:53:27.545704 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m02:53:27.545876 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m02:53:27.546045 [info ] [Thread-1 (]: 6 of 11 SKIP test unique_stg_youtube_video_id .................................. [[33mSKIP[0m]
[0m02:53:27.546286 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m02:53:27.546651 [debug] [Thread-1 (]: Began running node model.content_trend_advisor.features_content_engagement
[0m02:53:27.546850 [info ] [Thread-1 (]: 7 of 11 SKIP relation public_marts.features_content_engagement ................. [[33mSKIP[0m]
[0m02:53:27.547056 [debug] [Thread-1 (]: Finished running node model.content_trend_advisor.features_content_engagement
[0m02:53:27.547507 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341
[0m02:53:27.547778 [info ] [Thread-1 (]: 8 of 11 SKIP test accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low  [[33mSKIP[0m]
[0m02:53:27.548010 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341
[0m02:53:27.548380 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a
[0m02:53:27.548589 [info ] [Thread-1 (]: 9 of 11 SKIP test not_null_features_content_engagement_is_trending ............. [[33mSKIP[0m]
[0m02:53:27.548830 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a
[0m02:53:27.549024 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7
[0m02:53:27.549230 [info ] [Thread-1 (]: 10 of 11 SKIP test not_null_features_content_engagement_video_id ............... [[33mSKIP[0m]
[0m02:53:27.549542 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7
[0m02:53:27.549747 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221
[0m02:53:27.549930 [info ] [Thread-1 (]: 11 of 11 SKIP test unique_features_content_engagement_video_id ................. [[33mSKIP[0m]
[0m02:53:27.550167 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221
[0m02:53:27.551157 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:27.551315 [debug] [MainThread]: On master: BEGIN
[0m02:53:27.551435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:53:27.554745 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:53:27.555044 [debug] [MainThread]: On master: COMMIT
[0m02:53:27.555229 [debug] [MainThread]: Using postgres connection "master"
[0m02:53:27.555364 [debug] [MainThread]: On master: COMMIT
[0m02:53:27.555721 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:53:27.555857 [debug] [MainThread]: On master: Close
[0m02:53:27.556194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:53:27.556321 [debug] [MainThread]: Connection 'list_contentdb' was properly closed.
[0m02:53:27.556500 [debug] [MainThread]: Connection 'model.content_trend_advisor.stg_youtube' was properly closed.
[0m02:53:27.556717 [info ] [MainThread]: 
[0m02:53:27.556932 [info ] [MainThread]: Finished running 1 view model, 9 tests, 1 table model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m02:53:27.557696 [debug] [MainThread]: Command end result
[0m02:53:27.565013 [info ] [MainThread]: 
[0m02:53:27.565356 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:53:27.565839 [info ] [MainThread]: 
[0m02:53:27.566084 [error] [MainThread]:   Database Error in model stg_youtube (models/staging/stg_youtube.sql)
  column "view_count" does not exist
  LINE 79:     WHEN view_count::float > 0
                    ^
  compiled Code at target/run/content_trend_advisor/models/staging/stg_youtube.sql
[0m02:53:27.566477 [info ] [MainThread]: 
[0m02:53:27.566827 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=10 TOTAL=11
[0m02:53:27.567612 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.51301926, "process_user_time": 1.253362, "process_kernel_time": 0.389734, "process_mem_max_rss": "134816", "process_out_blocks": "3451", "command_success": false, "process_in_blocks": "0"}
[0m02:53:27.567872 [debug] [MainThread]: Command `dbt build` failed at 02:53:27.567820 after 0.51 seconds
[0m02:53:27.568124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e5f8890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e5cad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cbf3450>]}
[0m02:53:27.568353 [debug] [MainThread]: Flushing usage events
[0m02:53:59.638245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b7a6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b66db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb1e190>]}


============================== 02:53:59.641069 | 16f06ff8-b399-49ae-a5a7-08ab0e310253 ==============================
[0m02:53:59.641069 [info ] [MainThread]: Running with dbt=1.7.8
[0m02:53:59.641608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/services/transform', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/services/transform/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select stg_youtube+', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:53:59.752587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16f06ff8-b399-49ae-a5a7-08ab0e310253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a848390>]}
[0m02:53:59.787197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16f06ff8-b399-49ae-a5a7-08ab0e310253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b931350>]}
[0m02:53:59.787781 [info ] [MainThread]: Registered adapter: postgres=1.7.8
[0m02:53:59.800694 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m02:54:00.308355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:54:00.309105 [debug] [MainThread]: Partial parsing: updated file: content_trend_advisor://models/staging/stg_youtube.sql
[0m02:54:00.479448 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- snapshots.content_trend_advisor
[0m02:54:00.483245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16f06ff8-b399-49ae-a5a7-08ab0e310253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a2f9450>]}
[0m02:54:00.503913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16f06ff8-b399-49ae-a5a7-08ab0e310253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a4fc250>]}
[0m02:54:00.504365 [info ] [MainThread]: Found 12 tests, 2 models, 1 source, 0 exposures, 0 metrics, 529 macros, 0 groups, 0 semantic models
[0m02:54:00.505910 [info ] [MainThread]: 
[0m02:54:00.506808 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:54:00.513233 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contentdb'
[0m02:54:00.521231 [debug] [ThreadPool]: Using postgres connection "list_contentdb"
[0m02:54:00.521650 [debug] [ThreadPool]: On list_contentdb: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb"} */

    select distinct nspname from pg_namespace
  
[0m02:54:00.521838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:54:00.548136 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:54:00.550900 [debug] [ThreadPool]: On list_contentdb: Close
[0m02:54:00.552987 [debug] [ThreadPool]: Using postgres connection "list_contentdb"
[0m02:54:00.553305 [debug] [ThreadPool]: On list_contentdb: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb"} */

    select distinct nspname from pg_namespace
  
[0m02:54:00.553534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:54:00.562516 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:54:00.563309 [debug] [ThreadPool]: On list_contentdb: Close
[0m02:54:00.564888 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contentdb, now list_contentdb_public_marts)
[0m02:54:00.570067 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_marts"
[0m02:54:00.570546 [debug] [ThreadPool]: On list_contentdb_public_marts: BEGIN
[0m02:54:00.571003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:54:00.580259 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:54:00.580636 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_marts"
[0m02:54:00.580839 [debug] [ThreadPool]: On list_contentdb_public_marts: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb_public_marts"} */
select
      'contentdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'contentdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'contentdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m02:54:00.584092 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m02:54:00.584777 [debug] [ThreadPool]: On list_contentdb_public_marts: ROLLBACK
[0m02:54:00.585019 [debug] [ThreadPool]: On list_contentdb_public_marts: Close
[0m02:54:00.585566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contentdb_public_marts, now list_contentdb_public_staging)
[0m02:54:00.586578 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_staging"
[0m02:54:00.586721 [debug] [ThreadPool]: On list_contentdb_public_staging: BEGIN
[0m02:54:00.586850 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:54:00.594691 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:54:00.594861 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_staging"
[0m02:54:00.595009 [debug] [ThreadPool]: On list_contentdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb_public_staging"} */
select
      'contentdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'contentdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'contentdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m02:54:00.597010 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m02:54:00.597480 [debug] [ThreadPool]: On list_contentdb_public_staging: ROLLBACK
[0m02:54:00.597652 [debug] [ThreadPool]: On list_contentdb_public_staging: Close
[0m02:54:00.600458 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:00.600766 [debug] [MainThread]: On master: BEGIN
[0m02:54:00.600907 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:54:00.606010 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:54:00.606187 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:00.606371 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:54:00.613798 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m02:54:00.614589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16f06ff8-b399-49ae-a5a7-08ab0e310253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a480a90>]}
[0m02:54:00.614963 [debug] [MainThread]: On master: ROLLBACK
[0m02:54:00.615201 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:00.615333 [debug] [MainThread]: On master: BEGIN
[0m02:54:00.615566 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:54:00.615738 [debug] [MainThread]: On master: COMMIT
[0m02:54:00.615886 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:00.616023 [debug] [MainThread]: On master: COMMIT
[0m02:54:00.616263 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:54:00.616409 [debug] [MainThread]: On master: Close
[0m02:54:00.616862 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:54:00.617168 [info ] [MainThread]: 
[0m02:54:00.620685 [debug] [Thread-1 (]: Began running node model.content_trend_advisor.stg_youtube
[0m02:54:00.621084 [info ] [Thread-1 (]: 1 of 11 START sql view model public_staging.stg_youtube ........................ [RUN]
[0m02:54:00.621504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contentdb_public_staging, now model.content_trend_advisor.stg_youtube)
[0m02:54:00.621719 [debug] [Thread-1 (]: Began compiling node model.content_trend_advisor.stg_youtube
[0m02:54:00.626347 [debug] [Thread-1 (]: Writing injected SQL for node "model.content_trend_advisor.stg_youtube"
[0m02:54:00.627244 [debug] [Thread-1 (]: Timing info for model.content_trend_advisor.stg_youtube (compile): 02:54:00.621860 => 02:54:00.627129
[0m02:54:00.627467 [debug] [Thread-1 (]: Began executing node model.content_trend_advisor.stg_youtube
[0m02:54:00.642603 [debug] [Thread-1 (]: Writing runtime sql for node "model.content_trend_advisor.stg_youtube"
[0m02:54:00.643344 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:54:00.643529 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: BEGIN
[0m02:54:00.643685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:54:00.647733 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:54:00.647928 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:54:00.648160 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */

  create view "contentdb"."public_staging"."stg_youtube__dbt_tmp"
    
    
  as (
    WITH src AS (
  SELECT 
    external_id AS video_id,
    fetched_at,
    payload
  FROM "contentdb"."public"."raw_content"
  WHERE source = 'youtube'
), 

clean AS (
  SELECT
    video_id,

    /* Titles and descriptions: prefer localized when present */
    COALESCE(payload->'snippet'->'localized'->>'title', payload->'snippet'->>'title') AS title,
    LEFT(COALESCE(payload->'snippet'->'localized'->>'description', payload->'snippet'->>'description', ''), 1000) AS description,

    /* Channel and timing info */
    payload->'snippet'->>'channelId' AS channel_id,
    payload->'snippet'->>'channelTitle' AS channel_title,
    (payload->'snippet'->>'publishedAt')::timestamptz AS published_at,

    /* Category and language (note: YouTube uses camelCase keys) */
    payload->'snippet'->>'categoryId' AS category_id,
    payload->'snippet'->>'defaultAudioLanguage' AS default_audio_language,

    /* Core metrics from statistics (->> needs quoted keys) */
    COALESCE((payload->'statistics'->>'viewCount')::bigint, 0) AS view_count,
    COALESCE((payload->'statistics'->>'likeCount')::bigint, 0) AS like_count,
    COALESCE((payload->'statistics'->>'commentCount')::bigint, 0) AS comment_count,

    /* Duration as seconds from ISO8601 duration */
    CASE
      WHEN payload->'contentDetails'->>'duration' IS NOT NULL
        THEN 
  (
    COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[1], '0')::int * 3600
  + COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[2], '0')::int * 60
  + COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[3], '0')::int
  )

      ELSE NULL
    END AS duration_seconds,

    /* Tags, topics, categories */
    
  COALESCE(
    ARRAY(
      SELECT jsonb_array_elements_text(payload->'snippet'->'tags')
    ),
    ARRAY[]::text[]
  )
 AS tags,

    /* _filter_metadata.detected_topics is an array; use -> (JSONB) not ->> (text) */
    COALESCE(
      ARRAY(SELECT jsonb_array_elements_text(payload->'_filter_metadata'->'detected_topics')),
      ARRAY[]::text[]
    ) AS detected_topics,

    payload->'_filter_metadata'->>'detected_language' AS detected_language,
    payload->'_filter_metadata'->>'category_name' AS category_name,

    /* topicDetails.topicCategories is an array of URLs */
    COALESCE(
      ARRAY(SELECT jsonb_array_elements_text(payload->'topicDetails'->'topicCategories')),
      ARRAY[]::text[]
    ) AS topic_categories,

    /* Derived metrics */
    
  CASE
    WHEN COALESCE((payload->'statistics'->>'viewCount')::bigint, 0)::float > 0
      THEN ROUND(((COALESCE(COALESCE((payload->'statistics'->>'likeCount')::bigint, 0), 0) + COALESCE(COALESCE((payload->'statistics'->>'commentCount')::bigint, 0), 0))::float / COALESCE((payload->'statistics'->>'viewCount')::bigint, 0)::float) * 100, 2)
    ELSE 0
  END
 AS engagement_rate,
    DATE_TRUNC('day', fetched_at) AS fetched_date,
    EXTRACT(DAY FROM (NOW() - (payload->'snippet'->>'publishedAt')::timestamptz)) AS days_since_published

  FROM src
)

SELECT * FROM clean
  );
[0m02:54:00.651076 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function round(double precision, integer) does not exist
LINE 80:       THEN ROUND(((COALESCE(COALESCE((payload->'statistics'-...
                    ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m02:54:00.651269 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: ROLLBACK
[0m02:54:00.651559 [debug] [Thread-1 (]: Timing info for model.content_trend_advisor.stg_youtube (execute): 02:54:00.627588 => 02:54:00.651485
[0m02:54:00.651729 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: Close
[0m02:54:00.656428 [debug] [Thread-1 (]: Database Error in model stg_youtube (models/staging/stg_youtube.sql)
  function round(double precision, integer) does not exist
  LINE 80:       THEN ROUND(((COALESCE(COALESCE((payload->'statistics'-...
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/content_trend_advisor/models/staging/stg_youtube.sql
[0m02:54:00.656829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16f06ff8-b399-49ae-a5a7-08ab0e310253', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79ffd450>]}
[0m02:54:00.657192 [error] [Thread-1 (]: 1 of 11 ERROR creating sql view model public_staging.stg_youtube ............... [[31mERROR[0m in 0.04s]
[0m02:54:00.657587 [debug] [Thread-1 (]: Finished running node model.content_trend_advisor.stg_youtube
[0m02:54:00.658456 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.accepted_range_stg_youtube_engagement_rate__100__0.03b5eb9837
[0m02:54:00.658682 [info ] [Thread-1 (]: 2 of 11 SKIP test accepted_range_stg_youtube_engagement_rate__100__0 ........... [[33mSKIP[0m]
[0m02:54:00.658903 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.accepted_range_stg_youtube_engagement_rate__100__0.03b5eb9837
[0m02:54:00.659157 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m02:54:00.659364 [info ] [Thread-1 (]: 3 of 11 SKIP test not_null_stg_youtube_published_at ............................ [[33mSKIP[0m]
[0m02:54:00.659575 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m02:54:00.659776 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m02:54:00.659978 [info ] [Thread-1 (]: 4 of 11 SKIP test not_null_stg_youtube_video_id ................................ [[33mSKIP[0m]
[0m02:54:00.660207 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m02:54:00.660400 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m02:54:00.660603 [info ] [Thread-1 (]: 5 of 11 SKIP test not_null_stg_youtube_view_count .............................. [[33mSKIP[0m]
[0m02:54:00.660845 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m02:54:00.661033 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m02:54:00.661217 [info ] [Thread-1 (]: 6 of 11 SKIP test unique_stg_youtube_video_id .................................. [[33mSKIP[0m]
[0m02:54:00.661509 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m02:54:00.661910 [debug] [Thread-1 (]: Began running node model.content_trend_advisor.features_content_engagement
[0m02:54:00.662134 [info ] [Thread-1 (]: 7 of 11 SKIP relation public_marts.features_content_engagement ................. [[33mSKIP[0m]
[0m02:54:00.662395 [debug] [Thread-1 (]: Finished running node model.content_trend_advisor.features_content_engagement
[0m02:54:00.662943 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341
[0m02:54:00.663142 [info ] [Thread-1 (]: 8 of 11 SKIP test accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low  [[33mSKIP[0m]
[0m02:54:00.663410 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341
[0m02:54:00.663588 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a
[0m02:54:00.663770 [info ] [Thread-1 (]: 9 of 11 SKIP test not_null_features_content_engagement_is_trending ............. [[33mSKIP[0m]
[0m02:54:00.664114 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a
[0m02:54:00.664300 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7
[0m02:54:00.664471 [info ] [Thread-1 (]: 10 of 11 SKIP test not_null_features_content_engagement_video_id ............... [[33mSKIP[0m]
[0m02:54:00.664743 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7
[0m02:54:00.664916 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221
[0m02:54:00.665118 [info ] [Thread-1 (]: 11 of 11 SKIP test unique_features_content_engagement_video_id ................. [[33mSKIP[0m]
[0m02:54:00.665369 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221
[0m02:54:00.666167 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:00.666318 [debug] [MainThread]: On master: BEGIN
[0m02:54:00.666466 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:54:00.671320 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:54:00.671618 [debug] [MainThread]: On master: COMMIT
[0m02:54:00.671747 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:00.671861 [debug] [MainThread]: On master: COMMIT
[0m02:54:00.672008 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:54:00.672126 [debug] [MainThread]: On master: Close
[0m02:54:00.672508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:54:00.672660 [debug] [MainThread]: Connection 'model.content_trend_advisor.stg_youtube' was properly closed.
[0m02:54:00.672901 [info ] [MainThread]: 
[0m02:54:00.673175 [info ] [MainThread]: Finished running 1 view model, 9 tests, 1 table model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m02:54:00.673725 [debug] [MainThread]: Command end result
[0m02:54:00.683647 [info ] [MainThread]: 
[0m02:54:00.684108 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:54:00.684568 [info ] [MainThread]: 
[0m02:54:00.684776 [error] [MainThread]:   Database Error in model stg_youtube (models/staging/stg_youtube.sql)
  function round(double precision, integer) does not exist
  LINE 80:       THEN ROUND(((COALESCE(COALESCE((payload->'statistics'-...
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/content_trend_advisor/models/staging/stg_youtube.sql
[0m02:54:00.685105 [info ] [MainThread]: 
[0m02:54:00.685414 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=10 TOTAL=11
[0m02:54:00.686744 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 1.0732677, "process_user_time": 1.655167, "process_kernel_time": 0.299537, "process_mem_max_rss": "134892", "process_out_blocks": "3458", "command_success": false, "process_in_blocks": "0"}
[0m02:54:00.687066 [debug] [MainThread]: Command `dbt build` failed at 02:54:00.687012 after 1.07 seconds
[0m02:54:00.687353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b34ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb0cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b7e5750>]}
[0m02:54:00.687553 [debug] [MainThread]: Flushing usage events
[0m02:54:27.962967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a7ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94bead90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94dccb90>]}


============================== 02:54:27.964480 | 6a9346a2-f822-4649-a0b6-555f199dcf4d ==============================
[0m02:54:27.964480 [info ] [MainThread]: Running with dbt=1.7.8
[0m02:54:27.964941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/services/transform/logs', 'debug': 'False', 'profiles_dir': '/app/services/transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select stg_youtube+', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:54:28.040285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a9346a2-f822-4649-a0b6-555f199dcf4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff946063d0>]}
[0m02:54:28.077487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a9346a2-f822-4649-a0b6-555f199dcf4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a35c50>]}
[0m02:54:28.078310 [info ] [MainThread]: Registered adapter: postgres=1.7.8
[0m02:54:28.258118 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m02:54:28.527715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:54:28.529051 [debug] [MainThread]: Partial parsing: updated file: content_trend_advisor://macros/metrics.sql
[0m02:54:28.673420 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- snapshots.content_trend_advisor
[0m02:54:28.676723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a9346a2-f822-4649-a0b6-555f199dcf4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a454d0>]}
[0m02:54:28.691837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a9346a2-f822-4649-a0b6-555f199dcf4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933832d0>]}
[0m02:54:28.692519 [info ] [MainThread]: Found 12 tests, 2 models, 1 source, 0 exposures, 0 metrics, 529 macros, 0 groups, 0 semantic models
[0m02:54:28.695403 [info ] [MainThread]: 
[0m02:54:28.697521 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:54:28.702713 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contentdb'
[0m02:54:28.709815 [debug] [ThreadPool]: Using postgres connection "list_contentdb"
[0m02:54:28.710235 [debug] [ThreadPool]: On list_contentdb: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb"} */

    select distinct nspname from pg_namespace
  
[0m02:54:28.710621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:54:28.734260 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:54:28.736246 [debug] [ThreadPool]: On list_contentdb: Close
[0m02:54:28.738582 [debug] [ThreadPool]: Using postgres connection "list_contentdb"
[0m02:54:28.738988 [debug] [ThreadPool]: On list_contentdb: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb"} */

    select distinct nspname from pg_namespace
  
[0m02:54:28.739219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:54:28.748797 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:54:28.749595 [debug] [ThreadPool]: On list_contentdb: Close
[0m02:54:28.750806 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contentdb_public_staging'
[0m02:54:28.754124 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_staging"
[0m02:54:28.754343 [debug] [ThreadPool]: On list_contentdb_public_staging: BEGIN
[0m02:54:28.754474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:54:28.757603 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:54:28.757807 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_staging"
[0m02:54:28.757983 [debug] [ThreadPool]: On list_contentdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb_public_staging"} */
select
      'contentdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'contentdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'contentdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m02:54:28.761713 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m02:54:28.762393 [debug] [ThreadPool]: On list_contentdb_public_staging: ROLLBACK
[0m02:54:28.762610 [debug] [ThreadPool]: On list_contentdb_public_staging: Close
[0m02:54:28.763181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contentdb_public_staging, now list_contentdb_public_marts)
[0m02:54:28.764327 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_marts"
[0m02:54:28.764879 [debug] [ThreadPool]: On list_contentdb_public_marts: BEGIN
[0m02:54:28.765365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:54:28.769756 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:54:28.770690 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_marts"
[0m02:54:28.771995 [debug] [ThreadPool]: On list_contentdb_public_marts: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb_public_marts"} */
select
      'contentdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'contentdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'contentdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m02:54:28.773986 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m02:54:28.774751 [debug] [ThreadPool]: On list_contentdb_public_marts: ROLLBACK
[0m02:54:28.775000 [debug] [ThreadPool]: On list_contentdb_public_marts: Close
[0m02:54:28.777649 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:28.777959 [debug] [MainThread]: On master: BEGIN
[0m02:54:28.778103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:54:28.781132 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:54:28.781278 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:28.781449 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:54:28.785179 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m02:54:28.785712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a9346a2-f822-4649-a0b6-555f199dcf4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93950650>]}
[0m02:54:28.785996 [debug] [MainThread]: On master: ROLLBACK
[0m02:54:28.786191 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:28.786318 [debug] [MainThread]: On master: BEGIN
[0m02:54:28.786507 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:54:28.786641 [debug] [MainThread]: On master: COMMIT
[0m02:54:28.786768 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:28.786886 [debug] [MainThread]: On master: COMMIT
[0m02:54:28.787072 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:54:28.787229 [debug] [MainThread]: On master: Close
[0m02:54:28.787555 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:54:28.787836 [info ] [MainThread]: 
[0m02:54:28.789910 [debug] [Thread-1 (]: Began running node model.content_trend_advisor.stg_youtube
[0m02:54:28.790218 [info ] [Thread-1 (]: 1 of 11 START sql view model public_staging.stg_youtube ........................ [RUN]
[0m02:54:28.790635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contentdb_public_marts, now model.content_trend_advisor.stg_youtube)
[0m02:54:28.790855 [debug] [Thread-1 (]: Began compiling node model.content_trend_advisor.stg_youtube
[0m02:54:28.795040 [debug] [Thread-1 (]: Writing injected SQL for node "model.content_trend_advisor.stg_youtube"
[0m02:54:28.796346 [debug] [Thread-1 (]: Timing info for model.content_trend_advisor.stg_youtube (compile): 02:54:28.791012 => 02:54:28.796138
[0m02:54:28.796673 [debug] [Thread-1 (]: Began executing node model.content_trend_advisor.stg_youtube
[0m02:54:28.815520 [debug] [Thread-1 (]: Writing runtime sql for node "model.content_trend_advisor.stg_youtube"
[0m02:54:28.816146 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:54:28.816311 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: BEGIN
[0m02:54:28.816513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:54:28.821135 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:54:28.821320 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:54:28.821542 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */

  create view "contentdb"."public_staging"."stg_youtube__dbt_tmp"
    
    
  as (
    WITH src AS (
  SELECT 
    external_id AS video_id,
    fetched_at,
    payload
  FROM "contentdb"."public"."raw_content"
  WHERE source = 'youtube'
), 

clean AS (
  SELECT
    video_id,

    /* Titles and descriptions: prefer localized when present */
    COALESCE(payload->'snippet'->'localized'->>'title', payload->'snippet'->>'title') AS title,
    LEFT(COALESCE(payload->'snippet'->'localized'->>'description', payload->'snippet'->>'description', ''), 1000) AS description,

    /* Channel and timing info */
    payload->'snippet'->>'channelId' AS channel_id,
    payload->'snippet'->>'channelTitle' AS channel_title,
    (payload->'snippet'->>'publishedAt')::timestamptz AS published_at,

    /* Category and language (note: YouTube uses camelCase keys) */
    payload->'snippet'->>'categoryId' AS category_id,
    payload->'snippet'->>'defaultAudioLanguage' AS default_audio_language,

    /* Core metrics from statistics (->> needs quoted keys) */
    COALESCE((payload->'statistics'->>'viewCount')::bigint, 0) AS view_count,
    COALESCE((payload->'statistics'->>'likeCount')::bigint, 0) AS like_count,
    COALESCE((payload->'statistics'->>'commentCount')::bigint, 0) AS comment_count,

    /* Duration as seconds from ISO8601 duration */
    CASE
      WHEN payload->'contentDetails'->>'duration' IS NOT NULL
        THEN 
  (
    COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[1], '0')::int * 3600
  + COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[2], '0')::int * 60
  + COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[3], '0')::int
  )

      ELSE NULL
    END AS duration_seconds,

    /* Tags, topics, categories */
    
  COALESCE(
    ARRAY(
      SELECT jsonb_array_elements_text(payload->'snippet'->'tags')
    ),
    ARRAY[]::text[]
  )
 AS tags,

    /* _filter_metadata.detected_topics is an array; use -> (JSONB) not ->> (text) */
    COALESCE(
      ARRAY(SELECT jsonb_array_elements_text(payload->'_filter_metadata'->'detected_topics')),
      ARRAY[]::text[]
    ) AS detected_topics,

    payload->'_filter_metadata'->>'detected_language' AS detected_language,
    payload->'_filter_metadata'->>'category_name' AS category_name,

    /* topicDetails.topicCategories is an array of URLs */
    COALESCE(
      ARRAY(SELECT jsonb_array_elements_text(payload->'topicDetails'->'topicCategories')),
      ARRAY[]::text[]
    ) AS topic_categories,

    /* Derived metrics */
    
  CASE
    WHEN (COALESCE((payload->'statistics'->>'viewCount')::bigint, 0))::numeric > 0
      THEN ROUND(((COALESCE(COALESCE((payload->'statistics'->>'likeCount')::bigint, 0), 0))::numeric + (COALESCE(COALESCE((payload->'statistics'->>'commentCount')::bigint, 0), 0))::numeric) / (COALESCE((payload->'statistics'->>'viewCount')::bigint, 0))::numeric * 100::numeric, 2)
    ELSE 0::numeric
  END
 AS engagement_rate,
    DATE_TRUNC('day', fetched_at) AS fetched_date,
    EXTRACT(DAY FROM (NOW() - (payload->'snippet'->>'publishedAt')::timestamptz)) AS days_since_published

  FROM src
)

SELECT * FROM clean
  );
[0m02:54:28.843580 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:54:28.847545 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:54:28.847857 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */
alter table "contentdb"."public_staging"."stg_youtube__dbt_tmp" rename to "stg_youtube"
[0m02:54:28.849658 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:54:28.855466 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: COMMIT
[0m02:54:28.855645 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:54:28.855783 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: COMMIT
[0m02:54:28.860178 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:54:28.862577 [debug] [Thread-1 (]: Applying DROP to: "contentdb"."public_staging"."stg_youtube__dbt_backup"
[0m02:54:28.864514 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:54:28.864679 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */
drop view if exists "contentdb"."public_staging"."stg_youtube__dbt_backup" cascade
[0m02:54:28.865508 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m02:54:28.866272 [debug] [Thread-1 (]: Timing info for model.content_trend_advisor.stg_youtube (execute): 02:54:28.796852 => 02:54:28.866183
[0m02:54:28.866449 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: Close
[0m02:54:28.866924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9346a2-f822-4649-a0b6-555f199dcf4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff936f2fd0>]}
[0m02:54:28.867336 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public_staging.stg_youtube ................... [[32mCREATE VIEW[0m in 0.08s]
[0m02:54:28.868262 [debug] [Thread-1 (]: Finished running node model.content_trend_advisor.stg_youtube
[0m02:54:28.869124 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.accepted_range_stg_youtube_engagement_rate__100__0.03b5eb9837
[0m02:54:28.869329 [info ] [Thread-1 (]: 2 of 11 START test accepted_range_stg_youtube_engagement_rate__100__0 .......... [RUN]
[0m02:54:28.870083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.content_trend_advisor.stg_youtube, now test.content_trend_advisor.accepted_range_stg_youtube_engagement_rate__100__0.03b5eb9837)
[0m02:54:28.870440 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.accepted_range_stg_youtube_engagement_rate__100__0.03b5eb9837
[0m02:54:28.875119 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.accepted_range_stg_youtube_engagement_rate__100__0.03b5eb9837 (compile): 02:54:28.870632 => 02:54:28.874736
[0m02:54:28.878225 [debug] [Thread-1 (]: Compilation Error in test accepted_range_stg_youtube_engagement_rate__100__0 (models/staging/stg_youtube.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m02:54:28.878541 [error] [Thread-1 (]: 2 of 11 ERROR accepted_range_stg_youtube_engagement_rate__100__0 ............... [[31mERROR[0m in 0.01s]
[0m02:54:28.878930 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.accepted_range_stg_youtube_engagement_rate__100__0.03b5eb9837
[0m02:54:28.879230 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m02:54:28.879721 [info ] [Thread-1 (]: 3 of 11 START test not_null_stg_youtube_published_at ........................... [RUN]
[0m02:54:28.880153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.accepted_range_stg_youtube_engagement_rate__100__0.03b5eb9837, now test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757)
[0m02:54:28.880324 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m02:54:28.884297 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"
[0m02:54:28.885935 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757 (compile): 02:54:28.880443 => 02:54:28.885832
[0m02:54:28.886111 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m02:54:28.891939 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"
[0m02:54:28.892691 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"
[0m02:54:28.892839 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757: BEGIN
[0m02:54:28.892980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:54:28.896185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:54:28.896356 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"
[0m02:54:28.896506 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select published_at
from "contentdb"."public_staging"."stg_youtube"
where published_at is null



      
    ) dbt_internal_test
[0m02:54:28.948008 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:54:28.949831 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757 (execute): 02:54:28.886206 => 02:54:28.949676
[0m02:54:28.950171 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757: ROLLBACK
[0m02:54:28.950610 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757: Close
[0m02:54:28.951217 [info ] [Thread-1 (]: 3 of 11 PASS not_null_stg_youtube_published_at ................................. [[32mPASS[0m in 0.07s]
[0m02:54:28.951521 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m02:54:28.951891 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m02:54:28.952687 [info ] [Thread-1 (]: 4 of 11 START test not_null_stg_youtube_video_id ............................... [RUN]
[0m02:54:28.953426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757, now test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79)
[0m02:54:28.953708 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m02:54:28.956257 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"
[0m02:54:28.956973 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79 (compile): 02:54:28.953938 => 02:54:28.956878
[0m02:54:28.957137 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m02:54:28.959577 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"
[0m02:54:28.960401 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"
[0m02:54:28.960568 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79: BEGIN
[0m02:54:28.960731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:54:28.963508 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:54:28.963720 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"
[0m02:54:28.963919 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select video_id
from "contentdb"."public_staging"."stg_youtube"
where video_id is null



      
    ) dbt_internal_test
[0m02:54:28.969598 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:54:28.970653 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79 (execute): 02:54:28.957269 => 02:54:28.970523
[0m02:54:28.970907 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79: ROLLBACK
[0m02:54:28.971218 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79: Close
[0m02:54:28.971695 [info ] [Thread-1 (]: 4 of 11 PASS not_null_stg_youtube_video_id ..................................... [[32mPASS[0m in 0.02s]
[0m02:54:28.971967 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m02:54:28.972245 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m02:54:28.972497 [info ] [Thread-1 (]: 5 of 11 START test not_null_stg_youtube_view_count ............................. [RUN]
[0m02:54:28.972864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79, now test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9)
[0m02:54:28.973060 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m02:54:28.975118 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"
[0m02:54:28.975859 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9 (compile): 02:54:28.973173 => 02:54:28.975777
[0m02:54:28.976035 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m02:54:28.977040 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"
[0m02:54:28.978554 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"
[0m02:54:28.978851 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9: BEGIN
[0m02:54:28.979077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:54:28.982089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:54:28.982251 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"
[0m02:54:28.982400 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select view_count
from "contentdb"."public_staging"."stg_youtube"
where view_count is null



      
    ) dbt_internal_test
[0m02:54:28.986222 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:54:28.986952 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9 (execute): 02:54:28.976148 => 02:54:28.986860
[0m02:54:28.987173 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9: ROLLBACK
[0m02:54:28.987410 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9: Close
[0m02:54:28.987887 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stg_youtube_view_count ................................... [[32mPASS[0m in 0.02s]
[0m02:54:28.988248 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m02:54:28.988481 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m02:54:28.988719 [info ] [Thread-1 (]: 6 of 11 START test unique_stg_youtube_video_id ................................. [RUN]
[0m02:54:28.989052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9, now test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1)
[0m02:54:28.989209 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m02:54:28.992044 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"
[0m02:54:28.992563 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1 (compile): 02:54:28.989307 => 02:54:28.992484
[0m02:54:28.992723 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m02:54:28.993727 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"
[0m02:54:28.994431 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"
[0m02:54:28.994632 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1: BEGIN
[0m02:54:28.994775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:54:28.997474 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:54:28.997635 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"
[0m02:54:28.997785 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    video_id as unique_field,
    count(*) as n_records

from "contentdb"."public_staging"."stg_youtube"
where video_id is not null
group by video_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:54:28.999791 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:54:29.000700 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1 (execute): 02:54:28.992834 => 02:54:29.000583
[0m02:54:29.000898 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1: ROLLBACK
[0m02:54:29.001126 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1: Close
[0m02:54:29.001535 [info ] [Thread-1 (]: 6 of 11 PASS unique_stg_youtube_video_id ....................................... [[32mPASS[0m in 0.01s]
[0m02:54:29.001856 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m02:54:29.005401 [debug] [Thread-1 (]: Began running node model.content_trend_advisor.features_content_engagement
[0m02:54:29.005826 [info ] [Thread-1 (]: 7 of 11 SKIP relation public_marts.features_content_engagement ................. [[33mSKIP[0m]
[0m02:54:29.006229 [debug] [Thread-1 (]: Finished running node model.content_trend_advisor.features_content_engagement
[0m02:54:29.006848 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341
[0m02:54:29.007067 [info ] [Thread-1 (]: 8 of 11 SKIP test accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low  [[33mSKIP[0m]
[0m02:54:29.007275 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341
[0m02:54:29.007612 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a
[0m02:54:29.007839 [info ] [Thread-1 (]: 9 of 11 SKIP test not_null_features_content_engagement_is_trending ............. [[33mSKIP[0m]
[0m02:54:29.008079 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a
[0m02:54:29.008253 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7
[0m02:54:29.008431 [info ] [Thread-1 (]: 10 of 11 SKIP test not_null_features_content_engagement_video_id ............... [[33mSKIP[0m]
[0m02:54:29.008672 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7
[0m02:54:29.008863 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221
[0m02:54:29.009041 [info ] [Thread-1 (]: 11 of 11 SKIP test unique_features_content_engagement_video_id ................. [[33mSKIP[0m]
[0m02:54:29.009256 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221
[0m02:54:29.010315 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:29.010489 [debug] [MainThread]: On master: BEGIN
[0m02:54:29.010653 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:54:29.016271 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:54:29.016618 [debug] [MainThread]: On master: COMMIT
[0m02:54:29.016805 [debug] [MainThread]: Using postgres connection "master"
[0m02:54:29.016934 [debug] [MainThread]: On master: COMMIT
[0m02:54:29.017118 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:54:29.017257 [debug] [MainThread]: On master: Close
[0m02:54:29.017640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:54:29.017780 [debug] [MainThread]: Connection 'list_contentdb' was properly closed.
[0m02:54:29.017896 [debug] [MainThread]: Connection 'test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1' was properly closed.
[0m02:54:29.018098 [info ] [MainThread]: 
[0m02:54:29.018317 [info ] [MainThread]: Finished running 1 view model, 9 tests, 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m02:54:29.019133 [debug] [MainThread]: Command end result
[0m02:54:29.027161 [info ] [MainThread]: 
[0m02:54:29.027365 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:54:29.027557 [info ] [MainThread]: 
[0m02:54:29.027815 [error] [MainThread]:   Compilation Error in test accepted_range_stg_youtube_engagement_rate__100__0 (models/staging/stg_youtube.yml)
  'test_accepted_range' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m02:54:29.027986 [info ] [MainThread]: 
[0m02:54:29.028220 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=5 TOTAL=11
[0m02:54:29.031465 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 1.0880728, "process_user_time": 1.526007, "process_kernel_time": 0.228849, "process_mem_max_rss": "136352", "process_out_blocks": "3492", "command_success": false, "process_in_blocks": "0"}
[0m02:54:29.034348 [debug] [MainThread]: Command `dbt build` failed at 02:54:29.034062 after 1.09 seconds
[0m02:54:29.035099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff945d65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95490850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94c715d0>]}
[0m02:54:29.035460 [debug] [MainThread]: Flushing usage events
[0m02:55:19.112641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaad63050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab51e890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab196c10>]}


============================== 02:55:19.114405 | f3378dd5-e094-4116-b447-8a17d944c3bd ==============================
[0m02:55:19.114405 [info ] [MainThread]: Running with dbt=1.7.8
[0m02:55:19.114806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/services/transform', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/services/transform/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:55:19.151268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3378dd5-e094-4116-b447-8a17d944c3bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab1ea150>]}
[0m02:55:19.221047 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7unchi7k'
[0m02:55:19.221507 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:55:19.306643 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:55:19.307339 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m02:55:19.347703 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m02:55:19.349379 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:55:19.390628 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:55:19.393374 [info ] [MainThread]: Installing dbt-labs/codegen
[0m02:55:19.803442 [info ] [MainThread]: Installed from version 0.10.0
[0m02:55:19.803907 [info ] [MainThread]: Updated version available: 0.13.1
[0m02:55:19.804473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f3378dd5-e094-4116-b447-8a17d944c3bd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac34dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac37fd0>]}
[0m02:55:19.804773 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:55:20.342030 [info ] [MainThread]: Installed from version 1.1.1
[0m02:55:20.343424 [info ] [MainThread]: Updated version available: 1.3.0
[0m02:55:20.344299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f3378dd5-e094-4116-b447-8a17d944c3bd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb03d1410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab1e9b10>]}
[0m02:55:20.345199 [info ] [MainThread]: 
[0m02:55:20.345510 [info ] [MainThread]: Updates available for packages: ['dbt-labs/codegen', 'dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m02:55:20.349223 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.2569696, "process_user_time": 0.932284, "process_kernel_time": 0.312446, "process_mem_max_rss": "114428", "process_out_blocks": "996", "process_in_blocks": "0"}
[0m02:55:20.350074 [debug] [MainThread]: Command `dbt deps` succeeded at 02:55:20.349928 after 1.26 seconds
[0m02:55:20.350879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab44dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaad35990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab196dd0>]}
[0m02:55:20.351277 [debug] [MainThread]: Flushing usage events
[0m02:55:22.594538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a855ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c237c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8abccbd0>]}


============================== 02:55:22.596958 | f4309a4f-c1d9-4d58-84a3-bb250c043878 ==============================
[0m02:55:22.596958 [info ] [MainThread]: Running with dbt=1.7.8
[0m02:55:22.597391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/app/services/transform/logs', 'debug': 'False', 'profiles_dir': '/app/services/transform', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --select stg_youtube+', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:55:22.687113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4309a4f-c1d9-4d58-84a3-bb250c043878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89dba410>]}
[0m02:55:22.724831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4309a4f-c1d9-4d58-84a3-bb250c043878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89bf3190>]}
[0m02:55:22.725386 [info ] [MainThread]: Registered adapter: postgres=1.7.8
[0m02:55:22.734329 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m02:55:22.810299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:55:22.810764 [debug] [MainThread]: Partial parsing: updated file: content_trend_advisor://models/staging/stg_youtube.yml
[0m02:55:22.954521 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- snapshots.content_trend_advisor
[0m02:55:22.957445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4309a4f-c1d9-4d58-84a3-bb250c043878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff895c6b90>]}
[0m02:55:22.973462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4309a4f-c1d9-4d58-84a3-bb250c043878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff899fc190>]}
[0m02:55:22.973930 [info ] [MainThread]: Found 12 tests, 2 models, 1 source, 0 exposures, 0 metrics, 529 macros, 0 groups, 0 semantic models
[0m02:55:22.975694 [info ] [MainThread]: 
[0m02:55:22.976705 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:55:22.978974 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contentdb'
[0m02:55:22.984638 [debug] [ThreadPool]: Using postgres connection "list_contentdb"
[0m02:55:22.984942 [debug] [ThreadPool]: On list_contentdb: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb"} */

    select distinct nspname from pg_namespace
  
[0m02:55:22.985096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:55:23.010927 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:55:23.011922 [debug] [ThreadPool]: On list_contentdb: Close
[0m02:55:23.013621 [debug] [ThreadPool]: Using postgres connection "list_contentdb"
[0m02:55:23.013887 [debug] [ThreadPool]: On list_contentdb: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb"} */

    select distinct nspname from pg_namespace
  
[0m02:55:23.014073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:55:23.018915 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:55:23.019770 [debug] [ThreadPool]: On list_contentdb: Close
[0m02:55:23.021092 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contentdb_public_staging'
[0m02:55:23.024154 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_staging"
[0m02:55:23.024374 [debug] [ThreadPool]: On list_contentdb_public_staging: BEGIN
[0m02:55:23.024497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:55:23.030822 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:55:23.031068 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_staging"
[0m02:55:23.031300 [debug] [ThreadPool]: On list_contentdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb_public_staging"} */
select
      'contentdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'contentdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'contentdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m02:55:23.035690 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m02:55:23.036524 [debug] [ThreadPool]: On list_contentdb_public_staging: ROLLBACK
[0m02:55:23.036891 [debug] [ThreadPool]: On list_contentdb_public_staging: Close
[0m02:55:23.037981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contentdb_public_staging, now list_contentdb_public_marts)
[0m02:55:23.039618 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_marts"
[0m02:55:23.039901 [debug] [ThreadPool]: On list_contentdb_public_marts: BEGIN
[0m02:55:23.040052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:55:23.046082 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:55:23.046370 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_marts"
[0m02:55:23.046527 [debug] [ThreadPool]: On list_contentdb_public_marts: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb_public_marts"} */
select
      'contentdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'contentdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'contentdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m02:55:23.052797 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m02:55:23.053801 [debug] [ThreadPool]: On list_contentdb_public_marts: ROLLBACK
[0m02:55:23.054088 [debug] [ThreadPool]: On list_contentdb_public_marts: Close
[0m02:55:23.056655 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:23.056902 [debug] [MainThread]: On master: BEGIN
[0m02:55:23.057050 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:55:23.061194 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:55:23.061348 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:23.061526 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:55:23.067331 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m02:55:23.068049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4309a4f-c1d9-4d58-84a3-bb250c043878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ce2150>]}
[0m02:55:23.068317 [debug] [MainThread]: On master: ROLLBACK
[0m02:55:23.068516 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:23.068635 [debug] [MainThread]: On master: BEGIN
[0m02:55:23.068922 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:55:23.069085 [debug] [MainThread]: On master: COMMIT
[0m02:55:23.069225 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:23.069347 [debug] [MainThread]: On master: COMMIT
[0m02:55:23.069500 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:55:23.069618 [debug] [MainThread]: On master: Close
[0m02:55:23.070035 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:55:23.070231 [info ] [MainThread]: 
[0m02:55:23.072390 [debug] [Thread-1 (]: Began running node model.content_trend_advisor.stg_youtube
[0m02:55:23.072688 [info ] [Thread-1 (]: 1 of 11 START sql view model public_staging.stg_youtube ........................ [RUN]
[0m02:55:23.073056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contentdb_public_marts, now model.content_trend_advisor.stg_youtube)
[0m02:55:23.073233 [debug] [Thread-1 (]: Began compiling node model.content_trend_advisor.stg_youtube
[0m02:55:23.078091 [debug] [Thread-1 (]: Writing injected SQL for node "model.content_trend_advisor.stg_youtube"
[0m02:55:23.079072 [debug] [Thread-1 (]: Timing info for model.content_trend_advisor.stg_youtube (compile): 02:55:23.073351 => 02:55:23.078954
[0m02:55:23.079385 [debug] [Thread-1 (]: Began executing node model.content_trend_advisor.stg_youtube
[0m02:55:23.094926 [debug] [Thread-1 (]: Writing runtime sql for node "model.content_trend_advisor.stg_youtube"
[0m02:55:23.095557 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:55:23.095761 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: BEGIN
[0m02:55:23.095941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:55:23.100897 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:55:23.101105 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:55:23.101378 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */

  create view "contentdb"."public_staging"."stg_youtube__dbt_tmp"
    
    
  as (
    WITH src AS (
  SELECT 
    external_id AS video_id,
    fetched_at,
    payload
  FROM "contentdb"."public"."raw_content"
  WHERE source = 'youtube'
), 

clean AS (
  SELECT
    video_id,

    /* Titles and descriptions: prefer localized when present */
    COALESCE(payload->'snippet'->'localized'->>'title', payload->'snippet'->>'title') AS title,
    LEFT(COALESCE(payload->'snippet'->'localized'->>'description', payload->'snippet'->>'description', ''), 1000) AS description,

    /* Channel and timing info */
    payload->'snippet'->>'channelId' AS channel_id,
    payload->'snippet'->>'channelTitle' AS channel_title,
    (payload->'snippet'->>'publishedAt')::timestamptz AS published_at,

    /* Category and language (note: YouTube uses camelCase keys) */
    payload->'snippet'->>'categoryId' AS category_id,
    payload->'snippet'->>'defaultAudioLanguage' AS default_audio_language,

    /* Core metrics from statistics (->> needs quoted keys) */
    COALESCE((payload->'statistics'->>'viewCount')::bigint, 0) AS view_count,
    COALESCE((payload->'statistics'->>'likeCount')::bigint, 0) AS like_count,
    COALESCE((payload->'statistics'->>'commentCount')::bigint, 0) AS comment_count,

    /* Duration as seconds from ISO8601 duration */
    CASE
      WHEN payload->'contentDetails'->>'duration' IS NOT NULL
        THEN 
  (
    COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[1], '0')::int * 3600
  + COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[2], '0')::int * 60
  + COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[3], '0')::int
  )

      ELSE NULL
    END AS duration_seconds,

    /* Tags, topics, categories */
    
  COALESCE(
    ARRAY(
      SELECT jsonb_array_elements_text(payload->'snippet'->'tags')
    ),
    ARRAY[]::text[]
  )
 AS tags,

    /* _filter_metadata.detected_topics is an array; use -> (JSONB) not ->> (text) */
    COALESCE(
      ARRAY(SELECT jsonb_array_elements_text(payload->'_filter_metadata'->'detected_topics')),
      ARRAY[]::text[]
    ) AS detected_topics,

    payload->'_filter_metadata'->>'detected_language' AS detected_language,
    payload->'_filter_metadata'->>'category_name' AS category_name,

    /* topicDetails.topicCategories is an array of URLs */
    COALESCE(
      ARRAY(SELECT jsonb_array_elements_text(payload->'topicDetails'->'topicCategories')),
      ARRAY[]::text[]
    ) AS topic_categories,

    /* Derived metrics */
    
  CASE
    WHEN (COALESCE((payload->'statistics'->>'viewCount')::bigint, 0))::numeric > 0
      THEN ROUND(((COALESCE(COALESCE((payload->'statistics'->>'likeCount')::bigint, 0), 0))::numeric + (COALESCE(COALESCE((payload->'statistics'->>'commentCount')::bigint, 0), 0))::numeric) / (COALESCE((payload->'statistics'->>'viewCount')::bigint, 0))::numeric * 100::numeric, 2)
    ELSE 0::numeric
  END
 AS engagement_rate,
    DATE_TRUNC('day', fetched_at) AS fetched_date,
    EXTRACT(DAY FROM (NOW() - (payload->'snippet'->>'publishedAt')::timestamptz)) AS days_since_published

  FROM src
)

SELECT * FROM clean
  );
[0m02:55:23.106422 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:55:23.110428 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:55:23.110669 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */
alter table "contentdb"."public_staging"."stg_youtube" rename to "stg_youtube__dbt_backup"
[0m02:55:23.111619 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:55:23.112916 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:55:23.113074 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */
alter table "contentdb"."public_staging"."stg_youtube__dbt_tmp" rename to "stg_youtube"
[0m02:55:23.113451 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:55:23.119836 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: COMMIT
[0m02:55:23.120026 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:55:23.120171 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: COMMIT
[0m02:55:23.120928 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:55:23.123246 [debug] [Thread-1 (]: Applying DROP to: "contentdb"."public_staging"."stg_youtube__dbt_backup"
[0m02:55:23.125228 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:55:23.125391 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */
drop view if exists "contentdb"."public_staging"."stg_youtube__dbt_backup" cascade
[0m02:55:23.131507 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m02:55:23.133322 [debug] [Thread-1 (]: Timing info for model.content_trend_advisor.stg_youtube (execute): 02:55:23.079505 => 02:55:23.133041
[0m02:55:23.133603 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: Close
[0m02:55:23.134334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4309a4f-c1d9-4d58-84a3-bb250c043878', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89995590>]}
[0m02:55:23.134842 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public_staging.stg_youtube ................... [[32mCREATE VIEW[0m in 0.06s]
[0m02:55:23.135770 [debug] [Thread-1 (]: Finished running node model.content_trend_advisor.stg_youtube
[0m02:55:23.136568 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83
[0m02:55:23.136832 [info ] [Thread-1 (]: 2 of 11 START test dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0  [RUN]
[0m02:55:23.137269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.content_trend_advisor.stg_youtube, now test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83)
[0m02:55:23.137507 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83
[0m02:55:23.140214 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83"
[0m02:55:23.141012 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83 (compile): 02:55:23.137637 => 02:55:23.140914
[0m02:55:23.141241 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83
[0m02:55:23.148129 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83"
[0m02:55:23.148686 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83"
[0m02:55:23.148845 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83: BEGIN
[0m02:55:23.149012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:55:23.153909 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:55:23.154118 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83"
[0m02:55:23.154301 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "contentdb"."public_staging"."stg_youtube"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not engagement_rate >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not engagement_rate <= 100
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m02:55:23.188524 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:55:23.190219 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83 (execute): 02:55:23.141499 => 02:55:23.190078
[0m02:55:23.190464 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83: ROLLBACK
[0m02:55:23.190778 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83: Close
[0m02:55:23.191552 [error] [Thread-1 (]: 2 of 11 FAIL 1 dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0 .... [[31mFAIL 1[0m in 0.05s]
[0m02:55:23.192138 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83
[0m02:55:23.192457 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m02:55:23.193040 [info ] [Thread-1 (]: 3 of 11 START test not_null_stg_youtube_published_at ........................... [RUN]
[0m02:55:23.193439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83, now test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757)
[0m02:55:23.193629 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m02:55:23.196967 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"
[0m02:55:23.198058 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757 (compile): 02:55:23.193771 => 02:55:23.197953
[0m02:55:23.198238 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m02:55:23.199556 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"
[0m02:55:23.200711 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"
[0m02:55:23.201208 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757: BEGIN
[0m02:55:23.201398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:55:23.205202 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:55:23.205465 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"
[0m02:55:23.205717 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select published_at
from "contentdb"."public_staging"."stg_youtube"
where published_at is null



      
    ) dbt_internal_test
[0m02:55:23.209927 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:55:23.210761 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757 (execute): 02:55:23.198500 => 02:55:23.210646
[0m02:55:23.210967 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757: ROLLBACK
[0m02:55:23.211171 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757: Close
[0m02:55:23.211577 [info ] [Thread-1 (]: 3 of 11 PASS not_null_stg_youtube_published_at ................................. [[32mPASS[0m in 0.02s]
[0m02:55:23.212006 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m02:55:23.212203 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m02:55:23.212395 [info ] [Thread-1 (]: 4 of 11 START test not_null_stg_youtube_video_id ............................... [RUN]
[0m02:55:23.212713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757, now test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79)
[0m02:55:23.212905 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m02:55:23.214895 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"
[0m02:55:23.215402 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79 (compile): 02:55:23.213021 => 02:55:23.215317
[0m02:55:23.215565 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m02:55:23.216687 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"
[0m02:55:23.217420 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"
[0m02:55:23.217621 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79: BEGIN
[0m02:55:23.217897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:55:23.223865 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:55:23.224231 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"
[0m02:55:23.224413 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select video_id
from "contentdb"."public_staging"."stg_youtube"
where video_id is null



      
    ) dbt_internal_test
[0m02:55:23.225868 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:55:23.227139 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79 (execute): 02:55:23.215678 => 02:55:23.227002
[0m02:55:23.227539 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79: ROLLBACK
[0m02:55:23.228051 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79: Close
[0m02:55:23.228730 [info ] [Thread-1 (]: 4 of 11 PASS not_null_stg_youtube_video_id ..................................... [[32mPASS[0m in 0.02s]
[0m02:55:23.229456 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m02:55:23.230109 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m02:55:23.230515 [info ] [Thread-1 (]: 5 of 11 START test not_null_stg_youtube_view_count ............................. [RUN]
[0m02:55:23.231173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79, now test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9)
[0m02:55:23.231380 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m02:55:23.236442 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"
[0m02:55:23.237230 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9 (compile): 02:55:23.231512 => 02:55:23.237120
[0m02:55:23.237439 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m02:55:23.238881 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"
[0m02:55:23.239492 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"
[0m02:55:23.239651 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9: BEGIN
[0m02:55:23.239811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:55:23.248264 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:55:23.248683 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"
[0m02:55:23.248980 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select view_count
from "contentdb"."public_staging"."stg_youtube"
where view_count is null



      
    ) dbt_internal_test
[0m02:55:23.253257 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:55:23.254097 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9 (execute): 02:55:23.237569 => 02:55:23.253994
[0m02:55:23.254295 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9: ROLLBACK
[0m02:55:23.254504 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9: Close
[0m02:55:23.254989 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stg_youtube_view_count ................................... [[32mPASS[0m in 0.02s]
[0m02:55:23.255376 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m02:55:23.255712 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m02:55:23.255939 [info ] [Thread-1 (]: 6 of 11 START test unique_stg_youtube_video_id ................................. [RUN]
[0m02:55:23.256331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9, now test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1)
[0m02:55:23.256532 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m02:55:23.259513 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"
[0m02:55:23.260071 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1 (compile): 02:55:23.256638 => 02:55:23.259985
[0m02:55:23.260233 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m02:55:23.261478 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"
[0m02:55:23.261972 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"
[0m02:55:23.262133 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1: BEGIN
[0m02:55:23.262278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:55:23.265726 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:55:23.265954 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"
[0m02:55:23.266121 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    video_id as unique_field,
    count(*) as n_records

from "contentdb"."public_staging"."stg_youtube"
where video_id is not null
group by video_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:55:23.267829 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:55:23.268955 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1 (execute): 02:55:23.260336 => 02:55:23.268829
[0m02:55:23.269237 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1: ROLLBACK
[0m02:55:23.269540 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1: Close
[0m02:55:23.270011 [info ] [Thread-1 (]: 6 of 11 PASS unique_stg_youtube_video_id ....................................... [[32mPASS[0m in 0.01s]
[0m02:55:23.270353 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m02:55:23.271407 [debug] [Thread-1 (]: Began running node model.content_trend_advisor.features_content_engagement
[0m02:55:23.271722 [info ] [Thread-1 (]: 7 of 11 SKIP relation public_marts.features_content_engagement ................. [[33mSKIP[0m]
[0m02:55:23.272087 [debug] [Thread-1 (]: Finished running node model.content_trend_advisor.features_content_engagement
[0m02:55:23.272536 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341
[0m02:55:23.272730 [info ] [Thread-1 (]: 8 of 11 SKIP test accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low  [[33mSKIP[0m]
[0m02:55:23.272970 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341
[0m02:55:23.273166 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a
[0m02:55:23.273368 [info ] [Thread-1 (]: 9 of 11 SKIP test not_null_features_content_engagement_is_trending ............. [[33mSKIP[0m]
[0m02:55:23.273621 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a
[0m02:55:23.273850 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7
[0m02:55:23.274033 [info ] [Thread-1 (]: 10 of 11 SKIP test not_null_features_content_engagement_video_id ............... [[33mSKIP[0m]
[0m02:55:23.274257 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7
[0m02:55:23.274422 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221
[0m02:55:23.274583 [info ] [Thread-1 (]: 11 of 11 SKIP test unique_features_content_engagement_video_id ................. [[33mSKIP[0m]
[0m02:55:23.274910 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221
[0m02:55:23.276489 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:23.276713 [debug] [MainThread]: On master: BEGIN
[0m02:55:23.276847 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:55:23.281572 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:55:23.281894 [debug] [MainThread]: On master: COMMIT
[0m02:55:23.282160 [debug] [MainThread]: Using postgres connection "master"
[0m02:55:23.282294 [debug] [MainThread]: On master: COMMIT
[0m02:55:23.282594 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:55:23.282748 [debug] [MainThread]: On master: Close
[0m02:55:23.283139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:55:23.283360 [debug] [MainThread]: Connection 'list_contentdb' was properly closed.
[0m02:55:23.283531 [debug] [MainThread]: Connection 'test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1' was properly closed.
[0m02:55:23.283827 [info ] [MainThread]: 
[0m02:55:23.284269 [info ] [MainThread]: Finished running 1 view model, 9 tests, 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m02:55:23.285060 [debug] [MainThread]: Command end result
[0m02:55:23.293263 [info ] [MainThread]: 
[0m02:55:23.293487 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:55:23.293702 [info ] [MainThread]: 
[0m02:55:23.293895 [error] [MainThread]: [31mFailure in test dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0 (models/staging/stg_youtube.yml)[0m
[0m02:55:23.294200 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m02:55:23.294381 [info ] [MainThread]: 
[0m02:55:23.294670 [info ] [MainThread]:   compiled Code at target/compiled/content_trend_advisor/models/staging/stg_youtube.yml/dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.sql
[0m02:55:23.294863 [info ] [MainThread]: 
[0m02:55:23.295073 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=5 TOTAL=11
[0m02:55:23.295942 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.722228, "process_user_time": 1.283014, "process_kernel_time": 0.169605, "process_mem_max_rss": "135356", "process_out_blocks": "3508", "command_success": false, "process_in_blocks": "0"}
[0m02:55:23.296229 [debug] [MainThread]: Command `dbt build` failed at 02:55:23.296179 after 0.72 seconds
[0m02:55:23.296528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae4c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8accf750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab63650>]}
[0m02:55:23.296862 [debug] [MainThread]: Flushing usage events
[0m02:56:27.302151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0c30cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb096c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0ac3490>]}


============================== 02:56:27.304305 | a3f6c615-aee7-4023-97be-8524e4d0c9a1 ==============================
[0m02:56:27.304305 [info ] [MainThread]: Running with dbt=1.7.8
[0m02:56:27.304667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/app/services/transform', 'log_path': '/app/services/transform/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:56:27.343548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3f6c615-aee7-4023-97be-8524e4d0c9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0683950>]}
[0m02:56:27.422572 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tiaydd8_'
[0m02:56:27.423164 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:56:27.542602 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:56:27.543295 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m02:56:27.591002 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m02:56:27.592247 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:56:27.652214 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:56:27.654913 [info ] [MainThread]: Installing dbt-labs/codegen
[0m02:56:28.078311 [info ] [MainThread]: Installed from version 0.10.0
[0m02:56:28.079751 [info ] [MainThread]: Updated version available: 0.13.1
[0m02:56:28.081138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a3f6c615-aee7-4023-97be-8524e4d0c9a1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb096cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb06a23d0>]}
[0m02:56:28.082379 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:56:28.650007 [info ] [MainThread]: Installed from version 1.1.1
[0m02:56:28.650988 [info ] [MainThread]: Updated version available: 1.3.0
[0m02:56:28.651792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a3f6c615-aee7-4023-97be-8524e4d0c9a1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1967490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb06e9790>]}
[0m02:56:28.652157 [info ] [MainThread]: 
[0m02:56:28.652742 [info ] [MainThread]: Updates available for packages: ['dbt-labs/codegen', 'dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m02:56:28.657260 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.3787663, "process_user_time": 0.934306, "process_kernel_time": 0.636101, "process_mem_max_rss": "114408", "process_out_blocks": "996", "process_in_blocks": "0"}
[0m02:56:28.658052 [debug] [MainThread]: Command `dbt deps` succeeded at 02:56:28.657892 after 1.38 seconds
[0m02:56:28.658611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb05415d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0c33ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0823150>]}
[0m02:56:28.659000 [debug] [MainThread]: Flushing usage events
[0m02:56:30.848153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2f27150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4c2c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3508990>]}


============================== 02:56:30.849864 | 5ade9cd6-3286-4423-984e-dcf21a28829d ==============================
[0m02:56:30.849864 [info ] [MainThread]: Running with dbt=1.7.8
[0m02:56:30.850211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/services/transform', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/app/services/transform/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --select stg_youtube+', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:56:30.977698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ade9cd6-3286-4423-984e-dcf21a28829d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2312090>]}
[0m02:56:31.012828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ade9cd6-3286-4423-984e-dcf21a28829d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2243510>]}
[0m02:56:31.013384 [info ] [MainThread]: Registered adapter: postgres=1.7.8
[0m02:56:31.022230 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m02:56:31.109433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:56:31.109692 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:56:31.110081 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- snapshots.content_trend_advisor
[0m02:56:31.112888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ade9cd6-3286-4423-984e-dcf21a28829d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb210bfd0>]}
[0m02:56:31.126204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ade9cd6-3286-4423-984e-dcf21a28829d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2311090>]}
[0m02:56:31.126510 [info ] [MainThread]: Found 12 tests, 2 models, 1 source, 0 exposures, 0 metrics, 529 macros, 0 groups, 0 semantic models
[0m02:56:31.127696 [info ] [MainThread]: 
[0m02:56:31.128192 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m02:56:31.128931 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contentdb'
[0m02:56:31.133913 [debug] [ThreadPool]: Using postgres connection "list_contentdb"
[0m02:56:31.134150 [debug] [ThreadPool]: On list_contentdb: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb"} */

    select distinct nspname from pg_namespace
  
[0m02:56:31.134315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:56:31.148547 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:56:31.149915 [debug] [ThreadPool]: On list_contentdb: Close
[0m02:56:31.152032 [debug] [ThreadPool]: Using postgres connection "list_contentdb"
[0m02:56:31.152367 [debug] [ThreadPool]: On list_contentdb: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb"} */

    select distinct nspname from pg_namespace
  
[0m02:56:31.152555 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:56:31.180078 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m02:56:31.181017 [debug] [ThreadPool]: On list_contentdb: Close
[0m02:56:31.182190 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contentdb_public_marts'
[0m02:56:31.185498 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_marts"
[0m02:56:31.185858 [debug] [ThreadPool]: On list_contentdb_public_marts: BEGIN
[0m02:56:31.186006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:56:31.191554 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:56:31.192147 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_marts"
[0m02:56:31.192645 [debug] [ThreadPool]: On list_contentdb_public_marts: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb_public_marts"} */
select
      'contentdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'contentdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'contentdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m02:56:31.198040 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m02:56:31.198963 [debug] [ThreadPool]: On list_contentdb_public_marts: ROLLBACK
[0m02:56:31.199224 [debug] [ThreadPool]: On list_contentdb_public_marts: Close
[0m02:56:31.200523 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contentdb_public_marts, now list_contentdb_public_staging)
[0m02:56:31.202017 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_staging"
[0m02:56:31.202190 [debug] [ThreadPool]: On list_contentdb_public_staging: BEGIN
[0m02:56:31.202399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:56:31.206040 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m02:56:31.206267 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_staging"
[0m02:56:31.206427 [debug] [ThreadPool]: On list_contentdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb_public_staging"} */
select
      'contentdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'contentdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'contentdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m02:56:31.207763 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m02:56:31.208357 [debug] [ThreadPool]: On list_contentdb_public_staging: ROLLBACK
[0m02:56:31.208590 [debug] [ThreadPool]: On list_contentdb_public_staging: Close
[0m02:56:31.211065 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:31.211281 [debug] [MainThread]: On master: BEGIN
[0m02:56:31.211420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:56:31.214699 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:56:31.214834 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:31.215005 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m02:56:31.220674 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m02:56:31.221207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ade9cd6-3286-4423-984e-dcf21a28829d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1f3ad90>]}
[0m02:56:31.221505 [debug] [MainThread]: On master: ROLLBACK
[0m02:56:31.221685 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:31.221823 [debug] [MainThread]: On master: BEGIN
[0m02:56:31.222026 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:56:31.222171 [debug] [MainThread]: On master: COMMIT
[0m02:56:31.222294 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:31.222410 [debug] [MainThread]: On master: COMMIT
[0m02:56:31.222600 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:56:31.222741 [debug] [MainThread]: On master: Close
[0m02:56:31.223085 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:56:31.223335 [info ] [MainThread]: 
[0m02:56:31.225030 [debug] [Thread-1 (]: Began running node model.content_trend_advisor.stg_youtube
[0m02:56:31.225277 [info ] [Thread-1 (]: 1 of 11 START sql view model public_staging.stg_youtube ........................ [RUN]
[0m02:56:31.225782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contentdb_public_staging, now model.content_trend_advisor.stg_youtube)
[0m02:56:31.225949 [debug] [Thread-1 (]: Began compiling node model.content_trend_advisor.stg_youtube
[0m02:56:31.230562 [debug] [Thread-1 (]: Writing injected SQL for node "model.content_trend_advisor.stg_youtube"
[0m02:56:31.231138 [debug] [Thread-1 (]: Timing info for model.content_trend_advisor.stg_youtube (compile): 02:56:31.226072 => 02:56:31.231049
[0m02:56:31.231297 [debug] [Thread-1 (]: Began executing node model.content_trend_advisor.stg_youtube
[0m02:56:31.248365 [debug] [Thread-1 (]: Writing runtime sql for node "model.content_trend_advisor.stg_youtube"
[0m02:56:31.249188 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:56:31.249377 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: BEGIN
[0m02:56:31.249564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:56:31.257212 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:56:31.257619 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:56:31.257895 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */

  create view "contentdb"."public_staging"."stg_youtube__dbt_tmp"
    
    
  as (
    WITH src AS (
  SELECT 
    external_id AS video_id,
    fetched_at,
    payload
  FROM "contentdb"."public"."raw_content"
  WHERE source = 'youtube'
), 

clean AS (
  SELECT
    video_id,

    /* Titles and descriptions: prefer localized when present */
    COALESCE(payload->'snippet'->'localized'->>'title', payload->'snippet'->>'title') AS title,
    LEFT(COALESCE(payload->'snippet'->'localized'->>'description', payload->'snippet'->>'description', ''), 1000) AS description,

    /* Channel and timing info */
    payload->'snippet'->>'channelId' AS channel_id,
    payload->'snippet'->>'channelTitle' AS channel_title,
    (payload->'snippet'->>'publishedAt')::timestamptz AS published_at,

    /* Category and language (note: YouTube uses camelCase keys) */
    payload->'snippet'->>'categoryId' AS category_id,
    payload->'snippet'->>'defaultAudioLanguage' AS default_audio_language,

    /* Core metrics from statistics (->> needs quoted keys) */
    COALESCE((payload->'statistics'->>'viewCount')::bigint, 0) AS view_count,
    COALESCE((payload->'statistics'->>'likeCount')::bigint, 0) AS like_count,
    COALESCE((payload->'statistics'->>'commentCount')::bigint, 0) AS comment_count,

    /* Duration as seconds from ISO8601 duration */
    CASE
      WHEN payload->'contentDetails'->>'duration' IS NOT NULL
        THEN 
  (
    COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[1], '0')::int * 3600
  + COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[2], '0')::int * 60
  + COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[3], '0')::int
  )

      ELSE NULL
    END AS duration_seconds,

    /* Tags, topics, categories */
    
  COALESCE(
    ARRAY(
      SELECT jsonb_array_elements_text(payload->'snippet'->'tags')
    ),
    ARRAY[]::text[]
  )
 AS tags,

    /* _filter_metadata.detected_topics is an array; use -> (JSONB) not ->> (text) */
    COALESCE(
      ARRAY(SELECT jsonb_array_elements_text(payload->'_filter_metadata'->'detected_topics')),
      ARRAY[]::text[]
    ) AS detected_topics,

    payload->'_filter_metadata'->>'detected_language' AS detected_language,
    payload->'_filter_metadata'->>'category_name' AS category_name,

    /* topicDetails.topicCategories is an array of URLs */
    COALESCE(
      ARRAY(SELECT jsonb_array_elements_text(payload->'topicDetails'->'topicCategories')),
      ARRAY[]::text[]
    ) AS topic_categories,

    /* Derived metrics */
    
  CASE
    WHEN (COALESCE((payload->'statistics'->>'viewCount')::bigint, 0))::numeric > 0
      THEN ROUND(((COALESCE(COALESCE((payload->'statistics'->>'likeCount')::bigint, 0), 0))::numeric + (COALESCE(COALESCE((payload->'statistics'->>'commentCount')::bigint, 0), 0))::numeric) / (COALESCE((payload->'statistics'->>'viewCount')::bigint, 0))::numeric * 100::numeric, 2)
    ELSE 0::numeric
  END
 AS engagement_rate,
    DATE_TRUNC('day', fetched_at) AS fetched_date,
    EXTRACT(DAY FROM (NOW() - (payload->'snippet'->>'publishedAt')::timestamptz)) AS days_since_published

  FROM src
)

SELECT * FROM clean
  );
[0m02:56:31.269821 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m02:56:31.273218 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:56:31.273495 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */
alter table "contentdb"."public_staging"."stg_youtube" rename to "stg_youtube__dbt_backup"
[0m02:56:31.274566 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:31.275965 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:56:31.276144 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */
alter table "contentdb"."public_staging"."stg_youtube__dbt_tmp" rename to "stg_youtube"
[0m02:56:31.276787 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m02:56:31.283457 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: COMMIT
[0m02:56:31.283708 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:56:31.283852 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: COMMIT
[0m02:56:31.285588 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m02:56:31.288037 [debug] [Thread-1 (]: Applying DROP to: "contentdb"."public_staging"."stg_youtube__dbt_backup"
[0m02:56:31.289948 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m02:56:31.290114 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */
drop view if exists "contentdb"."public_staging"."stg_youtube__dbt_backup" cascade
[0m02:56:31.291664 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m02:56:31.292287 [debug] [Thread-1 (]: Timing info for model.content_trend_advisor.stg_youtube (execute): 02:56:31.231410 => 02:56:31.292207
[0m02:56:31.292450 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: Close
[0m02:56:31.292827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ade9cd6-3286-4423-984e-dcf21a28829d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2013f10>]}
[0m02:56:31.293117 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public_staging.stg_youtube ................... [[32mCREATE VIEW[0m in 0.07s]
[0m02:56:31.293480 [debug] [Thread-1 (]: Finished running node model.content_trend_advisor.stg_youtube
[0m02:56:31.294115 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83
[0m02:56:31.294299 [info ] [Thread-1 (]: 2 of 11 START test dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0  [RUN]
[0m02:56:31.294664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.content_trend_advisor.stg_youtube, now test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83)
[0m02:56:31.294825 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83
[0m02:56:31.299683 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83"
[0m02:56:31.300255 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83 (compile): 02:56:31.294923 => 02:56:31.300165
[0m02:56:31.300433 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83
[0m02:56:31.306832 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83"
[0m02:56:31.307248 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83"
[0m02:56:31.307407 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83: BEGIN
[0m02:56:31.307544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:56:31.309811 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:56:31.309975 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83"
[0m02:56:31.310143 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "contentdb"."public_staging"."stg_youtube"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not engagement_rate >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not engagement_rate <= 100
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m02:56:31.350471 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:56:31.351919 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83 (execute): 02:56:31.300547 => 02:56:31.351814
[0m02:56:31.352098 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83: ROLLBACK
[0m02:56:31.352319 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83: Close
[0m02:56:31.352844 [error] [Thread-1 (]: 2 of 11 FAIL 1 dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0 .... [[31mFAIL 1[0m in 0.06s]
[0m02:56:31.353322 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83
[0m02:56:31.353675 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m02:56:31.354187 [info ] [Thread-1 (]: 3 of 11 START test not_null_stg_youtube_published_at ........................... [RUN]
[0m02:56:31.354701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83, now test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757)
[0m02:56:31.354893 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m02:56:31.357836 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"
[0m02:56:31.358512 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757 (compile): 02:56:31.355003 => 02:56:31.358430
[0m02:56:31.358670 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m02:56:31.359712 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"
[0m02:56:31.360100 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"
[0m02:56:31.360252 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757: BEGIN
[0m02:56:31.360400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:56:31.363948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:56:31.364163 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"
[0m02:56:31.364347 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select published_at
from "contentdb"."public_staging"."stg_youtube"
where published_at is null



      
    ) dbt_internal_test
[0m02:56:31.369231 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:56:31.370181 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757 (execute): 02:56:31.358785 => 02:56:31.370076
[0m02:56:31.370418 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757: ROLLBACK
[0m02:56:31.370865 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757: Close
[0m02:56:31.371342 [info ] [Thread-1 (]: 3 of 11 PASS not_null_stg_youtube_published_at ................................. [[32mPASS[0m in 0.02s]
[0m02:56:31.371735 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m02:56:31.371944 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m02:56:31.372253 [info ] [Thread-1 (]: 4 of 11 START test not_null_stg_youtube_video_id ............................... [RUN]
[0m02:56:31.372630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757, now test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79)
[0m02:56:31.372818 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m02:56:31.374808 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"
[0m02:56:31.375386 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79 (compile): 02:56:31.372930 => 02:56:31.375308
[0m02:56:31.375546 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m02:56:31.377603 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"
[0m02:56:31.378134 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"
[0m02:56:31.378307 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79: BEGIN
[0m02:56:31.378469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:56:31.382191 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:56:31.382398 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"
[0m02:56:31.382551 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select video_id
from "contentdb"."public_staging"."stg_youtube"
where video_id is null



      
    ) dbt_internal_test
[0m02:56:31.384023 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:56:31.384714 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79 (execute): 02:56:31.375648 => 02:56:31.384626
[0m02:56:31.384878 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79: ROLLBACK
[0m02:56:31.385062 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79: Close
[0m02:56:31.385436 [info ] [Thread-1 (]: 4 of 11 PASS not_null_stg_youtube_video_id ..................................... [[32mPASS[0m in 0.01s]
[0m02:56:31.385718 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m02:56:31.385961 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m02:56:31.386172 [info ] [Thread-1 (]: 5 of 11 START test not_null_stg_youtube_view_count ............................. [RUN]
[0m02:56:31.386533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79, now test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9)
[0m02:56:31.386835 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m02:56:31.389428 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"
[0m02:56:31.390168 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9 (compile): 02:56:31.386979 => 02:56:31.390055
[0m02:56:31.390443 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m02:56:31.392319 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"
[0m02:56:31.393007 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"
[0m02:56:31.393186 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9: BEGIN
[0m02:56:31.393356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:56:31.396075 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:56:31.396245 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"
[0m02:56:31.396401 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select view_count
from "contentdb"."public_staging"."stg_youtube"
where view_count is null



      
    ) dbt_internal_test
[0m02:56:31.400260 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:56:31.401076 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9 (execute): 02:56:31.390611 => 02:56:31.400983
[0m02:56:31.401309 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9: ROLLBACK
[0m02:56:31.401612 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9: Close
[0m02:56:31.402178 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stg_youtube_view_count ................................... [[32mPASS[0m in 0.02s]
[0m02:56:31.402557 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m02:56:31.402865 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m02:56:31.403126 [info ] [Thread-1 (]: 6 of 11 START test unique_stg_youtube_video_id ................................. [RUN]
[0m02:56:31.403504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9, now test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1)
[0m02:56:31.403680 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m02:56:31.406561 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"
[0m02:56:31.407069 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1 (compile): 02:56:31.403794 => 02:56:31.406992
[0m02:56:31.407218 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m02:56:31.408231 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"
[0m02:56:31.408627 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"
[0m02:56:31.408771 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1: BEGIN
[0m02:56:31.408908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:56:31.422645 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m02:56:31.423368 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"
[0m02:56:31.424521 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    video_id as unique_field,
    count(*) as n_records

from "contentdb"."public_staging"."stg_youtube"
where video_id is not null
group by video_id
having count(*) > 1



      
    ) dbt_internal_test
[0m02:56:31.430645 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m02:56:31.432122 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1 (execute): 02:56:31.407315 => 02:56:31.432010
[0m02:56:31.432331 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1: ROLLBACK
[0m02:56:31.432605 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1: Close
[0m02:56:31.433159 [info ] [Thread-1 (]: 6 of 11 PASS unique_stg_youtube_video_id ....................................... [[32mPASS[0m in 0.03s]
[0m02:56:31.433637 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m02:56:31.434443 [debug] [Thread-1 (]: Began running node model.content_trend_advisor.features_content_engagement
[0m02:56:31.434689 [info ] [Thread-1 (]: 7 of 11 SKIP relation public_marts.features_content_engagement ................. [[33mSKIP[0m]
[0m02:56:31.435104 [debug] [Thread-1 (]: Finished running node model.content_trend_advisor.features_content_engagement
[0m02:56:31.436069 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341
[0m02:56:31.436677 [info ] [Thread-1 (]: 8 of 11 SKIP test accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low  [[33mSKIP[0m]
[0m02:56:31.437005 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341
[0m02:56:31.437296 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a
[0m02:56:31.437521 [info ] [Thread-1 (]: 9 of 11 SKIP test not_null_features_content_engagement_is_trending ............. [[33mSKIP[0m]
[0m02:56:31.437830 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a
[0m02:56:31.438029 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7
[0m02:56:31.438217 [info ] [Thread-1 (]: 10 of 11 SKIP test not_null_features_content_engagement_video_id ............... [[33mSKIP[0m]
[0m02:56:31.438461 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7
[0m02:56:31.438639 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221
[0m02:56:31.438796 [info ] [Thread-1 (]: 11 of 11 SKIP test unique_features_content_engagement_video_id ................. [[33mSKIP[0m]
[0m02:56:31.438997 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221
[0m02:56:31.440109 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:31.440265 [debug] [MainThread]: On master: BEGIN
[0m02:56:31.440382 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:56:31.443549 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m02:56:31.443722 [debug] [MainThread]: On master: COMMIT
[0m02:56:31.443851 [debug] [MainThread]: Using postgres connection "master"
[0m02:56:31.443969 [debug] [MainThread]: On master: COMMIT
[0m02:56:31.444127 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m02:56:31.444246 [debug] [MainThread]: On master: Close
[0m02:56:31.444602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:56:31.444798 [debug] [MainThread]: Connection 'list_contentdb' was properly closed.
[0m02:56:31.444962 [debug] [MainThread]: Connection 'test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1' was properly closed.
[0m02:56:31.445380 [info ] [MainThread]: 
[0m02:56:31.445630 [info ] [MainThread]: Finished running 1 view model, 9 tests, 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m02:56:31.446273 [debug] [MainThread]: Command end result
[0m02:56:31.457953 [info ] [MainThread]: 
[0m02:56:31.458312 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:56:31.458638 [info ] [MainThread]: 
[0m02:56:31.458961 [error] [MainThread]: [31mFailure in test dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0 (models/staging/stg_youtube.yml)[0m
[0m02:56:31.459160 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m02:56:31.459353 [info ] [MainThread]: 
[0m02:56:31.459584 [info ] [MainThread]:   compiled Code at target/compiled/content_trend_advisor/models/staging/stg_youtube.yml/dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.sql
[0m02:56:31.459760 [info ] [MainThread]: 
[0m02:56:31.459958 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=5 TOTAL=11
[0m02:56:31.461029 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.6318178, "process_user_time": 1.17462, "process_kernel_time": 0.204281, "process_mem_max_rss": "129812", "process_out_blocks": "2392", "command_success": false, "process_in_blocks": "0"}
[0m02:56:31.461405 [debug] [MainThread]: Command `dbt build` failed at 02:56:31.461334 after 0.63 seconds
[0m02:56:31.461712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3508990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2096590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2d2ce10>]}
[0m02:56:31.461927 [debug] [MainThread]: Flushing usage events
[0m09:15:05.504985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a12dd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a6d25d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99fca3d0>]}


============================== 09:15:05.512388 | b4f67511-16f5-47b5-a8f4-dffbf3446510 ==============================
[0m09:15:05.512388 [info ] [MainThread]: Running with dbt=1.7.8
[0m09:15:05.512783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/app/services/transform', 'log_path': '/app/services/transform/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select stg_youtube+', 'send_anonymous_usage_stats': 'True'}
[0m09:15:05.637705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4f67511-16f5-47b5-a8f4-dffbf3446510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99ba4cd0>]}
[0m09:15:05.675748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4f67511-16f5-47b5-a8f4-dffbf3446510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99047410>]}
[0m09:15:05.676818 [info ] [MainThread]: Registered adapter: postgres=1.7.8
[0m09:15:05.692642 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m09:15:05.829599 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m09:15:05.830151 [debug] [MainThread]: Partial parsing: updated file: content_trend_advisor://models/staging/stg_youtube.yml
[0m09:15:05.830442 [debug] [MainThread]: Partial parsing: updated file: content_trend_advisor://models/marts/features_content_engagement.sql
[0m09:15:05.830654 [debug] [MainThread]: Partial parsing: updated file: content_trend_advisor://macros/metrics.sql
[0m09:15:05.830826 [debug] [MainThread]: Partial parsing: updated file: content_trend_advisor://models/staging/stg_youtube.sql
[0m09:15:05.986890 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- snapshots.content_trend_advisor
[0m09:15:05.991812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4f67511-16f5-47b5-a8f4-dffbf3446510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff989b3450>]}
[0m09:15:06.008973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4f67511-16f5-47b5-a8f4-dffbf3446510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98cb3150>]}
[0m09:15:06.009366 [info ] [MainThread]: Found 13 tests, 2 models, 1 source, 0 exposures, 0 metrics, 530 macros, 0 groups, 0 semantic models
[0m09:15:06.011863 [info ] [MainThread]: 
[0m09:15:06.012924 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:15:06.020673 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contentdb'
[0m09:15:06.030465 [debug] [ThreadPool]: Using postgres connection "list_contentdb"
[0m09:15:06.030843 [debug] [ThreadPool]: On list_contentdb: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb"} */

    select distinct nspname from pg_namespace
  
[0m09:15:06.031005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:15:06.092584 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m09:15:06.093737 [debug] [ThreadPool]: On list_contentdb: Close
[0m09:15:06.095646 [debug] [ThreadPool]: Using postgres connection "list_contentdb"
[0m09:15:06.095870 [debug] [ThreadPool]: On list_contentdb: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb"} */

    select distinct nspname from pg_namespace
  
[0m09:15:06.096023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:15:06.103075 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m09:15:06.104029 [debug] [ThreadPool]: On list_contentdb: Close
[0m09:15:06.105274 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contentdb_public_staging'
[0m09:15:06.109198 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_staging"
[0m09:15:06.109640 [debug] [ThreadPool]: On list_contentdb_public_staging: BEGIN
[0m09:15:06.109934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:15:06.116472 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:15:06.118859 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_staging"
[0m09:15:06.119455 [debug] [ThreadPool]: On list_contentdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb_public_staging"} */
select
      'contentdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'contentdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'contentdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m09:15:06.132996 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m09:15:06.134107 [debug] [ThreadPool]: On list_contentdb_public_staging: ROLLBACK
[0m09:15:06.134412 [debug] [ThreadPool]: On list_contentdb_public_staging: Close
[0m09:15:06.135302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contentdb_public_staging, now list_contentdb_public_marts)
[0m09:15:06.136863 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_marts"
[0m09:15:06.137020 [debug] [ThreadPool]: On list_contentdb_public_marts: BEGIN
[0m09:15:06.137175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:15:06.150621 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:15:06.150909 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_marts"
[0m09:15:06.151076 [debug] [ThreadPool]: On list_contentdb_public_marts: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb_public_marts"} */
select
      'contentdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'contentdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'contentdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m09:15:06.156964 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m09:15:06.157739 [debug] [ThreadPool]: On list_contentdb_public_marts: ROLLBACK
[0m09:15:06.157980 [debug] [ThreadPool]: On list_contentdb_public_marts: Close
[0m09:15:06.160588 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:06.160797 [debug] [MainThread]: On master: BEGIN
[0m09:15:06.160938 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:15:06.168359 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:15:06.168530 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:06.168716 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:15:06.201691 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m09:15:06.202522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4f67511-16f5-47b5-a8f4-dffbf3446510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98c6b410>]}
[0m09:15:06.202906 [debug] [MainThread]: On master: ROLLBACK
[0m09:15:06.203114 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:06.203239 [debug] [MainThread]: On master: BEGIN
[0m09:15:06.203457 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:15:06.203610 [debug] [MainThread]: On master: COMMIT
[0m09:15:06.203752 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:06.203890 [debug] [MainThread]: On master: COMMIT
[0m09:15:06.204042 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:15:06.204168 [debug] [MainThread]: On master: Close
[0m09:15:06.204573 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:15:06.204860 [info ] [MainThread]: 
[0m09:15:06.208740 [debug] [Thread-1 (]: Began running node model.content_trend_advisor.stg_youtube
[0m09:15:06.209013 [info ] [Thread-1 (]: 1 of 12 START sql view model public_staging.stg_youtube ........................ [RUN]
[0m09:15:06.209501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contentdb_public_marts, now model.content_trend_advisor.stg_youtube)
[0m09:15:06.209683 [debug] [Thread-1 (]: Began compiling node model.content_trend_advisor.stg_youtube
[0m09:15:06.215419 [debug] [Thread-1 (]: Writing injected SQL for node "model.content_trend_advisor.stg_youtube"
[0m09:15:06.216257 [debug] [Thread-1 (]: Timing info for model.content_trend_advisor.stg_youtube (compile): 09:15:06.209819 => 09:15:06.216124
[0m09:15:06.216455 [debug] [Thread-1 (]: Began executing node model.content_trend_advisor.stg_youtube
[0m09:15:06.231416 [debug] [Thread-1 (]: Writing runtime sql for node "model.content_trend_advisor.stg_youtube"
[0m09:15:06.232318 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m09:15:06.232483 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: BEGIN
[0m09:15:06.232678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:06.244164 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:15:06.244812 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m09:15:06.245133 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */

  create view "contentdb"."public_staging"."stg_youtube__dbt_tmp"
    
    
  as (
    WITH src AS (
  SELECT 
    external_id AS video_id,
    fetched_at,
    payload
  FROM "contentdb"."public"."raw_content"
  WHERE source = 'youtube'
), 

clean AS (
  SELECT
    video_id,

    /* Titles and descriptions: prefer localized when present */
    COALESCE(payload->'snippet'->'localized'->>'title', payload->'snippet'->>'title') AS title,
    LEFT(COALESCE(payload->'snippet'->'localized'->>'description', payload->'snippet'->>'description', ''), 1000) AS description,

    /* Channel and timing info */
    payload->'snippet'->>'channelId' AS channel_id,
    payload->'snippet'->>'channelTitle' AS channel_title,
    (payload->'snippet'->>'publishedAt')::timestamptz AS published_at,

    /* Category and language (note: YouTube uses camelCase keys) */
    payload->'snippet'->>'categoryId' AS category_id,
    payload->'snippet'->>'defaultAudioLanguage' AS default_audio_language,

    /* Core metrics from statistics (->> needs quoted keys) */
    COALESCE((payload->'statistics'->>'viewCount')::bigint, 0) AS view_count,
    COALESCE((payload->'statistics'->>'likeCount')::bigint, 0) AS like_count,
    COALESCE((payload->'statistics'->>'commentCount')::bigint, 0) AS comment_count,

    /* Duration as seconds from ISO8601 duration */
    CASE
      WHEN payload->'contentDetails'->>'duration' IS NOT NULL
        THEN 
  (
    COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[1], '0')::int * 3600
  + COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[2], '0')::int * 60
  + COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[3], '0')::int
  )

      ELSE NULL
    END AS duration_seconds,

    /* Tags, topics, categories */
    
  COALESCE(
    ARRAY(
      SELECT jsonb_array_elements_text(payload->'snippet'->'tags')
    ),
    ARRAY[]::text[]
  )
 AS tags,

    /* _filter_metadata.detected_topics is an array; use -> (JSONB) not ->> (text) */
    COALESCE(
      ARRAY(SELECT jsonb_array_elements_text(payload->'_filter_metadata'->'detected_topics')),
      ARRAY[]::text[]
    ) AS detected_topics,

    payload->'_filter_metadata'->>'detected_language' AS detected_language,
    payload->'_filter_metadata'->>'category_name' AS category_name,

    /* topicDetails.topicCategories is an array of URLs */
    COALESCE(
      ARRAY(SELECT jsonb_array_elements_text(payload->'topicDetails'->'topicCategories')),
      ARRAY[]::text[]
    ) AS topic_categories,

    /* Derived metrics */
    
  CASE
    WHEN (COALESCE((payload->'statistics'->>'viewCount')::bigint, 0))::numeric > 0
      THEN ((COALESCE(COALESCE((payload->'statistics'->>'likeCount')::bigint, 0), 0))::numeric + (COALESCE(COALESCE((payload->'statistics'->>'commentCount')::bigint, 0), 0))::numeric) / (COALESCE((payload->'statistics'->>'viewCount')::bigint, 0))::numeric
    ELSE 0::numeric
  END
 AS engagement_ratio_raw,
    /* Keep a percentage for readability, but derived from the raw ratio */
    ROUND((
      
  CASE
    WHEN (COALESCE((payload->'statistics'->>'viewCount')::bigint, 0))::numeric > 0
      THEN ((COALESCE(COALESCE((payload->'statistics'->>'likeCount')::bigint, 0), 0))::numeric + (COALESCE(COALESCE((payload->'statistics'->>'commentCount')::bigint, 0), 0))::numeric) / (COALESCE((payload->'statistics'->>'viewCount')::bigint, 0))::numeric
    ELSE 0::numeric
  END
 * 100::numeric
    ), 2) AS engagement_rate,
    DATE_TRUNC('day', fetched_at) AS fetched_date,
    EXTRACT(DAY FROM (NOW() - (payload->'snippet'->>'publishedAt')::timestamptz)) AS days_since_published

  FROM src
)

SELECT * FROM clean
  );
[0m09:15:06.296180 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:15:06.300707 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m09:15:06.300980 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */
alter table "contentdb"."public_staging"."stg_youtube" rename to "stg_youtube__dbt_backup"
[0m09:15:06.304441 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:15:06.306048 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m09:15:06.306235 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */
alter table "contentdb"."public_staging"."stg_youtube__dbt_tmp" rename to "stg_youtube"
[0m09:15:06.307406 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:15:06.314111 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: COMMIT
[0m09:15:06.314393 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m09:15:06.314533 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: COMMIT
[0m09:15:06.317220 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:15:06.319767 [debug] [Thread-1 (]: Applying DROP to: "contentdb"."public_staging"."stg_youtube__dbt_backup"
[0m09:15:06.321961 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m09:15:06.322116 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */
drop view if exists "contentdb"."public_staging"."stg_youtube__dbt_backup" cascade
[0m09:15:06.327204 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:15:06.327920 [debug] [Thread-1 (]: Timing info for model.content_trend_advisor.stg_youtube (execute): 09:15:06.216564 => 09:15:06.327825
[0m09:15:06.328090 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: Close
[0m09:15:06.328633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4f67511-16f5-47b5-a8f4-dffbf3446510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98cb1090>]}
[0m09:15:06.329032 [info ] [Thread-1 (]: 1 of 12 OK created sql view model public_staging.stg_youtube ................... [[32mCREATE VIEW[0m in 0.12s]
[0m09:15:06.329540 [debug] [Thread-1 (]: Finished running node model.content_trend_advisor.stg_youtube
[0m09:15:06.330347 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83
[0m09:15:06.330517 [info ] [Thread-1 (]: 2 of 12 START test dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0  [RUN]
[0m09:15:06.330866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.content_trend_advisor.stg_youtube, now test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83)
[0m09:15:06.331066 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83
[0m09:15:06.332992 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83"
[0m09:15:06.334037 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83 (compile): 09:15:06.331175 => 09:15:06.333950
[0m09:15:06.334195 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83
[0m09:15:06.341516 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83"
[0m09:15:06.342372 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83"
[0m09:15:06.342784 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83: BEGIN
[0m09:15:06.343125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:06.348662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:15:06.349033 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83"
[0m09:15:06.349256 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "contentdb"."public_staging"."stg_youtube"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not engagement_rate >= 0
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not engagement_rate <= 100
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m09:15:06.435531 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:15:06.438521 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83 (execute): 09:15:06.334296 => 09:15:06.438340
[0m09:15:06.438808 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83: ROLLBACK
[0m09:15:06.439149 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83: Close
[0m09:15:06.439764 [error] [Thread-1 (]: 2 of 12 FAIL 1 dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0 .... [[31mFAIL 1[0m in 0.11s]
[0m09:15:06.440288 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83
[0m09:15:06.440626 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6
[0m09:15:06.441292 [info ] [Thread-1 (]: 3 of 12 START test dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0  [RUN]
[0m09:15:06.441730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.a3471adb83, now test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6)
[0m09:15:06.441954 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6
[0m09:15:06.444736 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6"
[0m09:15:06.445570 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6 (compile): 09:15:06.442092 => 09:15:06.445467
[0m09:15:06.445763 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6
[0m09:15:06.446896 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6"
[0m09:15:06.447372 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6"
[0m09:15:06.447537 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6: BEGIN
[0m09:15:06.454075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:06.464314 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:15:06.464855 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6"
[0m09:15:06.465323 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "contentdb"."public_staging"."stg_youtube"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not engagement_ratio_raw >= 0
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m09:15:06.475140 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:15:06.476127 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6 (execute): 09:15:06.445873 => 09:15:06.476012
[0m09:15:06.476361 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6: ROLLBACK
[0m09:15:06.476715 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6: Close
[0m09:15:06.477752 [info ] [Thread-1 (]: 3 of 12 PASS dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0 ...... [[32mPASS[0m in 0.04s]
[0m09:15:06.479249 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6
[0m09:15:06.479803 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m09:15:06.480252 [info ] [Thread-1 (]: 4 of 12 START test not_null_stg_youtube_published_at ........................... [RUN]
[0m09:15:06.481191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6, now test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757)
[0m09:15:06.481406 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m09:15:06.486457 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"
[0m09:15:06.487184 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757 (compile): 09:15:06.481528 => 09:15:06.487082
[0m09:15:06.487395 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m09:15:06.488641 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"
[0m09:15:06.489172 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"
[0m09:15:06.489352 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757: BEGIN
[0m09:15:06.489503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:06.492390 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:15:06.492567 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"
[0m09:15:06.492718 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select published_at
from "contentdb"."public_staging"."stg_youtube"
where published_at is null



      
    ) dbt_internal_test
[0m09:15:06.496829 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:15:06.497490 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757 (execute): 09:15:06.487552 => 09:15:06.497408
[0m09:15:06.497641 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757: ROLLBACK
[0m09:15:06.497821 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757: Close
[0m09:15:06.498198 [info ] [Thread-1 (]: 4 of 12 PASS not_null_stg_youtube_published_at ................................. [[32mPASS[0m in 0.02s]
[0m09:15:06.498522 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m09:15:06.498800 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m09:15:06.499088 [info ] [Thread-1 (]: 5 of 12 START test not_null_stg_youtube_video_id ............................... [RUN]
[0m09:15:06.499469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757, now test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79)
[0m09:15:06.499702 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m09:15:06.501598 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"
[0m09:15:06.502100 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79 (compile): 09:15:06.499812 => 09:15:06.502017
[0m09:15:06.502245 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m09:15:06.503212 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"
[0m09:15:06.503640 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"
[0m09:15:06.503782 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79: BEGIN
[0m09:15:06.503914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:06.506794 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:15:06.506957 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"
[0m09:15:06.507106 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select video_id
from "contentdb"."public_staging"."stg_youtube"
where video_id is null



      
    ) dbt_internal_test
[0m09:15:06.508298 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:15:06.508925 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79 (execute): 09:15:06.502351 => 09:15:06.508841
[0m09:15:06.509075 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79: ROLLBACK
[0m09:15:06.509252 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79: Close
[0m09:15:06.509598 [info ] [Thread-1 (]: 5 of 12 PASS not_null_stg_youtube_video_id ..................................... [[32mPASS[0m in 0.01s]
[0m09:15:06.509866 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m09:15:06.510362 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m09:15:06.510571 [info ] [Thread-1 (]: 6 of 12 START test not_null_stg_youtube_view_count ............................. [RUN]
[0m09:15:06.510869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79, now test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9)
[0m09:15:06.511082 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m09:15:06.513095 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"
[0m09:15:06.513648 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9 (compile): 09:15:06.511206 => 09:15:06.513561
[0m09:15:06.513816 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m09:15:06.514855 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"
[0m09:15:06.515509 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"
[0m09:15:06.515660 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9: BEGIN
[0m09:15:06.515853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:06.518647 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:15:06.518826 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"
[0m09:15:06.518987 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select view_count
from "contentdb"."public_staging"."stg_youtube"
where view_count is null



      
    ) dbt_internal_test
[0m09:15:06.522480 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:15:06.523236 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9 (execute): 09:15:06.513919 => 09:15:06.523150
[0m09:15:06.523411 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9: ROLLBACK
[0m09:15:06.523611 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9: Close
[0m09:15:06.524030 [info ] [Thread-1 (]: 6 of 12 PASS not_null_stg_youtube_view_count ................................... [[32mPASS[0m in 0.01s]
[0m09:15:06.524407 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m09:15:06.524808 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m09:15:06.525519 [info ] [Thread-1 (]: 7 of 12 START test unique_stg_youtube_video_id ................................. [RUN]
[0m09:15:06.525869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9, now test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1)
[0m09:15:06.526181 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m09:15:06.530707 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"
[0m09:15:06.531370 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1 (compile): 09:15:06.526522 => 09:15:06.531280
[0m09:15:06.531528 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m09:15:06.532598 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"
[0m09:15:06.533174 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"
[0m09:15:06.533353 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1: BEGIN
[0m09:15:06.533498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:15:06.538003 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:15:06.538241 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"
[0m09:15:06.538403 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    video_id as unique_field,
    count(*) as n_records

from "contentdb"."public_staging"."stg_youtube"
where video_id is not null
group by video_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:15:06.539835 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:15:06.540518 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1 (execute): 09:15:06.531626 => 09:15:06.540431
[0m09:15:06.540679 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1: ROLLBACK
[0m09:15:06.540864 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1: Close
[0m09:15:06.541231 [info ] [Thread-1 (]: 7 of 12 PASS unique_stg_youtube_video_id ....................................... [[32mPASS[0m in 0.02s]
[0m09:15:06.541555 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m09:15:06.542189 [debug] [Thread-1 (]: Began running node model.content_trend_advisor.features_content_engagement
[0m09:15:06.542437 [info ] [Thread-1 (]: 8 of 12 SKIP relation public_marts.features_content_engagement ................. [[33mSKIP[0m]
[0m09:15:06.542953 [debug] [Thread-1 (]: Finished running node model.content_trend_advisor.features_content_engagement
[0m09:15:06.544026 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341
[0m09:15:06.544325 [info ] [Thread-1 (]: 9 of 12 SKIP test accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low  [[33mSKIP[0m]
[0m09:15:06.544710 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341
[0m09:15:06.544998 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a
[0m09:15:06.545294 [info ] [Thread-1 (]: 10 of 12 SKIP test not_null_features_content_engagement_is_trending ............ [[33mSKIP[0m]
[0m09:15:06.545516 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a
[0m09:15:06.545701 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7
[0m09:15:06.546194 [info ] [Thread-1 (]: 11 of 12 SKIP test not_null_features_content_engagement_video_id ............... [[33mSKIP[0m]
[0m09:15:06.546492 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7
[0m09:15:06.546700 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221
[0m09:15:06.546910 [info ] [Thread-1 (]: 12 of 12 SKIP test unique_features_content_engagement_video_id ................. [[33mSKIP[0m]
[0m09:15:06.547130 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221
[0m09:15:06.548297 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:06.548451 [debug] [MainThread]: On master: BEGIN
[0m09:15:06.548570 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:15:06.552623 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:15:06.552831 [debug] [MainThread]: On master: COMMIT
[0m09:15:06.552964 [debug] [MainThread]: Using postgres connection "master"
[0m09:15:06.553099 [debug] [MainThread]: On master: COMMIT
[0m09:15:06.553262 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:15:06.553407 [debug] [MainThread]: On master: Close
[0m09:15:06.553791 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:15:06.553921 [debug] [MainThread]: Connection 'list_contentdb' was properly closed.
[0m09:15:06.554044 [debug] [MainThread]: Connection 'test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1' was properly closed.
[0m09:15:06.554293 [info ] [MainThread]: 
[0m09:15:06.554572 [info ] [MainThread]: Finished running 1 view model, 10 tests, 1 table model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m09:15:06.555428 [debug] [MainThread]: Command end result
[0m09:15:06.569897 [info ] [MainThread]: 
[0m09:15:06.570218 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:15:06.570589 [info ] [MainThread]: 
[0m09:15:06.570908 [error] [MainThread]: [31mFailure in test dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0 (models/staging/stg_youtube.yml)[0m
[0m09:15:06.571086 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m09:15:06.571243 [info ] [MainThread]: 
[0m09:15:06.571464 [info ] [MainThread]:   compiled Code at target/compiled/content_trend_advisor/models/staging/stg_youtube.yml/dbt_utils_accepted_range_stg_youtube_engagement_rate__100__0.sql
[0m09:15:06.571633 [info ] [MainThread]: 
[0m09:15:06.571889 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=5 TOTAL=12
[0m09:15:06.574480 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 1.100869, "process_user_time": 1.658995, "process_kernel_time": 3.150435, "process_mem_max_rss": "135708", "process_out_blocks": "3549", "command_success": false, "process_in_blocks": "0"}
[0m09:15:06.575102 [debug] [MainThread]: Command `dbt build` failed at 09:15:06.574976 after 1.10 seconds
[0m09:15:06.575761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99ff5810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99ff7690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98ff4850>]}
[0m09:15:06.576418 [debug] [MainThread]: Flushing usage events
[0m09:16:18.680141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9356bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9935450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9804410>]}


============================== 09:16:18.683437 | 15d77f20-1a69-499f-b86d-33e7c77de938 ==============================
[0m09:16:18.683437 [info ] [MainThread]: Running with dbt=1.7.8
[0m09:16:18.683863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/app/services/transform', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/app/services/transform/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build --select stg_youtube+', 'send_anonymous_usage_stats': 'True'}
[0m09:16:18.805817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15d77f20-1a69-499f-b86d-33e7c77de938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa938c110>]}
[0m09:16:18.842479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15d77f20-1a69-499f-b86d-33e7c77de938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa87ddc50>]}
[0m09:16:18.843122 [info ] [MainThread]: Registered adapter: postgres=1.7.8
[0m09:16:18.856833 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m09:16:19.124983 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:16:19.148981 [debug] [MainThread]: Partial parsing: updated file: content_trend_advisor://models/staging/stg_youtube.yml
[0m09:16:19.689840 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- snapshots.content_trend_advisor
[0m09:16:19.694899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15d77f20-1a69-499f-b86d-33e7c77de938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa81b6a50>]}
[0m09:16:19.753392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15d77f20-1a69-499f-b86d-33e7c77de938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa938c110>]}
[0m09:16:19.754960 [info ] [MainThread]: Found 13 tests, 2 models, 1 source, 0 exposures, 0 metrics, 530 macros, 0 groups, 0 semantic models
[0m09:16:19.762702 [info ] [MainThread]: 
[0m09:16:19.763949 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:16:19.766143 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contentdb'
[0m09:16:19.775613 [debug] [ThreadPool]: Using postgres connection "list_contentdb"
[0m09:16:19.775947 [debug] [ThreadPool]: On list_contentdb: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb"} */

    select distinct nspname from pg_namespace
  
[0m09:16:19.776188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:16:19.812509 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m09:16:19.814389 [debug] [ThreadPool]: On list_contentdb: Close
[0m09:16:19.816557 [debug] [ThreadPool]: Using postgres connection "list_contentdb"
[0m09:16:19.816836 [debug] [ThreadPool]: On list_contentdb: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb"} */

    select distinct nspname from pg_namespace
  
[0m09:16:19.816979 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:16:19.841708 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m09:16:19.842525 [debug] [ThreadPool]: On list_contentdb: Close
[0m09:16:19.843822 [debug] [ThreadPool]: Acquiring new postgres connection 'list_contentdb_public_marts'
[0m09:16:19.852549 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_marts"
[0m09:16:19.853207 [debug] [ThreadPool]: On list_contentdb_public_marts: BEGIN
[0m09:16:19.854065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:16:19.862714 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:16:19.863076 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_marts"
[0m09:16:19.863279 [debug] [ThreadPool]: On list_contentdb_public_marts: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb_public_marts"} */
select
      'contentdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'contentdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'contentdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m09:16:19.869705 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m09:16:19.870441 [debug] [ThreadPool]: On list_contentdb_public_marts: ROLLBACK
[0m09:16:19.870674 [debug] [ThreadPool]: On list_contentdb_public_marts: Close
[0m09:16:19.871298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_contentdb_public_marts, now list_contentdb_public_staging)
[0m09:16:19.872400 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_staging"
[0m09:16:19.872628 [debug] [ThreadPool]: On list_contentdb_public_staging: BEGIN
[0m09:16:19.872819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:16:19.883411 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m09:16:19.883740 [debug] [ThreadPool]: Using postgres connection "list_contentdb_public_staging"
[0m09:16:19.883933 [debug] [ThreadPool]: On list_contentdb_public_staging: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "list_contentdb_public_staging"} */
select
      'contentdb' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'contentdb' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'contentdb' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m09:16:19.885588 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m09:16:19.886233 [debug] [ThreadPool]: On list_contentdb_public_staging: ROLLBACK
[0m09:16:19.886441 [debug] [ThreadPool]: On list_contentdb_public_staging: Close
[0m09:16:19.889083 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:19.889355 [debug] [MainThread]: On master: BEGIN
[0m09:16:19.889496 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:16:19.901190 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:16:19.901410 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:19.901602 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:16:19.910912 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m09:16:19.912024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15d77f20-1a69-499f-b86d-33e7c77de938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa811efd0>]}
[0m09:16:19.912633 [debug] [MainThread]: On master: ROLLBACK
[0m09:16:19.912918 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:19.913155 [debug] [MainThread]: On master: BEGIN
[0m09:16:19.913459 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:16:19.913628 [debug] [MainThread]: On master: COMMIT
[0m09:16:19.913769 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:19.913895 [debug] [MainThread]: On master: COMMIT
[0m09:16:19.914076 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:16:19.914223 [debug] [MainThread]: On master: Close
[0m09:16:19.914775 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:16:19.915133 [info ] [MainThread]: 
[0m09:16:19.919964 [debug] [Thread-1 (]: Began running node model.content_trend_advisor.stg_youtube
[0m09:16:19.920564 [info ] [Thread-1 (]: 1 of 12 START sql view model public_staging.stg_youtube ........................ [RUN]
[0m09:16:19.921450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_contentdb_public_staging, now model.content_trend_advisor.stg_youtube)
[0m09:16:19.921691 [debug] [Thread-1 (]: Began compiling node model.content_trend_advisor.stg_youtube
[0m09:16:19.927733 [debug] [Thread-1 (]: Writing injected SQL for node "model.content_trend_advisor.stg_youtube"
[0m09:16:19.928615 [debug] [Thread-1 (]: Timing info for model.content_trend_advisor.stg_youtube (compile): 09:16:19.921872 => 09:16:19.928490
[0m09:16:19.928806 [debug] [Thread-1 (]: Began executing node model.content_trend_advisor.stg_youtube
[0m09:16:19.947742 [debug] [Thread-1 (]: Writing runtime sql for node "model.content_trend_advisor.stg_youtube"
[0m09:16:19.948865 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m09:16:19.949104 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: BEGIN
[0m09:16:19.949292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:19.955062 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:16:19.955243 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m09:16:19.955526 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */

  create view "contentdb"."public_staging"."stg_youtube__dbt_tmp"
    
    
  as (
    WITH src AS (
  SELECT 
    external_id AS video_id,
    fetched_at,
    payload
  FROM "contentdb"."public"."raw_content"
  WHERE source = 'youtube'
), 

clean AS (
  SELECT
    video_id,

    /* Titles and descriptions: prefer localized when present */
    COALESCE(payload->'snippet'->'localized'->>'title', payload->'snippet'->>'title') AS title,
    LEFT(COALESCE(payload->'snippet'->'localized'->>'description', payload->'snippet'->>'description', ''), 1000) AS description,

    /* Channel and timing info */
    payload->'snippet'->>'channelId' AS channel_id,
    payload->'snippet'->>'channelTitle' AS channel_title,
    (payload->'snippet'->>'publishedAt')::timestamptz AS published_at,

    /* Category and language (note: YouTube uses camelCase keys) */
    payload->'snippet'->>'categoryId' AS category_id,
    payload->'snippet'->>'defaultAudioLanguage' AS default_audio_language,

    /* Core metrics from statistics (->> needs quoted keys) */
    COALESCE((payload->'statistics'->>'viewCount')::bigint, 0) AS view_count,
    COALESCE((payload->'statistics'->>'likeCount')::bigint, 0) AS like_count,
    COALESCE((payload->'statistics'->>'commentCount')::bigint, 0) AS comment_count,

    /* Duration as seconds from ISO8601 duration */
    CASE
      WHEN payload->'contentDetails'->>'duration' IS NOT NULL
        THEN 
  (
    COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[1], '0')::int * 3600
  + COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[2], '0')::int * 60
  + COALESCE( (regexp_match((payload->'contentDetails'->>'duration'), 'PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?'))[3], '0')::int
  )

      ELSE NULL
    END AS duration_seconds,

    /* Tags, topics, categories */
    
  COALESCE(
    ARRAY(
      SELECT jsonb_array_elements_text(payload->'snippet'->'tags')
    ),
    ARRAY[]::text[]
  )
 AS tags,

    /* _filter_metadata.detected_topics is an array; use -> (JSONB) not ->> (text) */
    COALESCE(
      ARRAY(SELECT jsonb_array_elements_text(payload->'_filter_metadata'->'detected_topics')),
      ARRAY[]::text[]
    ) AS detected_topics,

    payload->'_filter_metadata'->>'detected_language' AS detected_language,
    payload->'_filter_metadata'->>'category_name' AS category_name,

    /* topicDetails.topicCategories is an array of URLs */
    COALESCE(
      ARRAY(SELECT jsonb_array_elements_text(payload->'topicDetails'->'topicCategories')),
      ARRAY[]::text[]
    ) AS topic_categories,

    /* Derived metrics */
    
  CASE
    WHEN (COALESCE((payload->'statistics'->>'viewCount')::bigint, 0))::numeric > 0
      THEN ((COALESCE(COALESCE((payload->'statistics'->>'likeCount')::bigint, 0), 0))::numeric + (COALESCE(COALESCE((payload->'statistics'->>'commentCount')::bigint, 0), 0))::numeric) / (COALESCE((payload->'statistics'->>'viewCount')::bigint, 0))::numeric
    ELSE 0::numeric
  END
 AS engagement_ratio_raw,
    /* Keep a percentage for readability, but derived from the raw ratio */
    ROUND((
      
  CASE
    WHEN (COALESCE((payload->'statistics'->>'viewCount')::bigint, 0))::numeric > 0
      THEN ((COALESCE(COALESCE((payload->'statistics'->>'likeCount')::bigint, 0), 0))::numeric + (COALESCE(COALESCE((payload->'statistics'->>'commentCount')::bigint, 0), 0))::numeric) / (COALESCE((payload->'statistics'->>'viewCount')::bigint, 0))::numeric
    ELSE 0::numeric
  END
 * 100::numeric
    ), 2) AS engagement_rate,
    DATE_TRUNC('day', fetched_at) AS fetched_date,
    EXTRACT(DAY FROM (NOW() - (payload->'snippet'->>'publishedAt')::timestamptz)) AS days_since_published

  FROM src
)

SELECT * FROM clean
  );
[0m09:16:19.965999 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m09:16:19.971108 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m09:16:19.971488 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */
alter table "contentdb"."public_staging"."stg_youtube" rename to "stg_youtube__dbt_backup"
[0m09:16:19.972167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:16:19.974219 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m09:16:19.974517 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */
alter table "contentdb"."public_staging"."stg_youtube__dbt_tmp" rename to "stg_youtube"
[0m09:16:19.975050 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:16:19.985532 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: COMMIT
[0m09:16:19.986205 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m09:16:19.986504 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: COMMIT
[0m09:16:19.993627 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:16:19.997887 [debug] [Thread-1 (]: Applying DROP to: "contentdb"."public_staging"."stg_youtube__dbt_backup"
[0m09:16:20.000931 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.stg_youtube"
[0m09:16:20.001202 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.stg_youtube"} */
drop view if exists "contentdb"."public_staging"."stg_youtube__dbt_backup" cascade
[0m09:16:20.004049 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m09:16:20.005319 [debug] [Thread-1 (]: Timing info for model.content_trend_advisor.stg_youtube (execute): 09:16:19.928918 => 09:16:20.005193
[0m09:16:20.005518 [debug] [Thread-1 (]: On model.content_trend_advisor.stg_youtube: Close
[0m09:16:20.006180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15d77f20-1a69-499f-b86d-33e7c77de938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8556950>]}
[0m09:16:20.006637 [info ] [Thread-1 (]: 1 of 12 OK created sql view model public_staging.stg_youtube ................... [[32mCREATE VIEW[0m in 0.08s]
[0m09:16:20.007044 [debug] [Thread-1 (]: Finished running node model.content_trend_advisor.stg_youtube
[0m09:16:20.008101 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__0.70a2155d40
[0m09:16:20.008336 [info ] [Thread-1 (]: 2 of 12 START test dbt_utils_accepted_range_stg_youtube_engagement_rate__0 ..... [RUN]
[0m09:16:20.008862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.content_trend_advisor.stg_youtube, now test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__0.70a2155d40)
[0m09:16:20.009040 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__0.70a2155d40
[0m09:16:20.011466 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__0.70a2155d40"
[0m09:16:20.012371 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__0.70a2155d40 (compile): 09:16:20.009152 => 09:16:20.012246
[0m09:16:20.012585 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__0.70a2155d40
[0m09:16:20.022403 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__0.70a2155d40"
[0m09:16:20.023096 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__0.70a2155d40"
[0m09:16:20.023283 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__0.70a2155d40: BEGIN
[0m09:16:20.023438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:20.028024 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:16:20.028203 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__0.70a2155d40"
[0m09:16:20.028384 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__0.70a2155d40: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__0.70a2155d40"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "contentdb"."public_staging"."stg_youtube"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not engagement_rate >= 0
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m09:16:20.040861 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:16:20.042487 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__0.70a2155d40 (execute): 09:16:20.012914 => 09:16:20.042384
[0m09:16:20.042671 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__0.70a2155d40: ROLLBACK
[0m09:16:20.042893 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__0.70a2155d40: Close
[0m09:16:20.043314 [info ] [Thread-1 (]: 2 of 12 PASS dbt_utils_accepted_range_stg_youtube_engagement_rate__0 ........... [[32mPASS[0m in 0.03s]
[0m09:16:20.043749 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__0.70a2155d40
[0m09:16:20.044113 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6
[0m09:16:20.044331 [info ] [Thread-1 (]: 3 of 12 START test dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0  [RUN]
[0m09:16:20.044760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_rate__0.70a2155d40, now test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6)
[0m09:16:20.045010 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6
[0m09:16:20.047724 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6"
[0m09:16:20.048559 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6 (compile): 09:16:20.045665 => 09:16:20.048437
[0m09:16:20.048747 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6
[0m09:16:20.050184 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6"
[0m09:16:20.050805 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6"
[0m09:16:20.050962 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6: BEGIN
[0m09:16:20.051102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:20.057475 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:16:20.057978 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6"
[0m09:16:20.058170 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "contentdb"."public_staging"."stg_youtube"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not engagement_ratio_raw >= 0
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m09:16:20.067732 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:16:20.068631 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6 (execute): 09:16:20.048849 => 09:16:20.068531
[0m09:16:20.068817 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6: ROLLBACK
[0m09:16:20.069025 [debug] [Thread-1 (]: On test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6: Close
[0m09:16:20.069440 [info ] [Thread-1 (]: 3 of 12 PASS dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0 ...... [[32mPASS[0m in 0.02s]
[0m09:16:20.069736 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6
[0m09:16:20.070041 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m09:16:20.070265 [info ] [Thread-1 (]: 4 of 12 START test not_null_stg_youtube_published_at ........................... [RUN]
[0m09:16:20.070640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.dbt_utils_accepted_range_stg_youtube_engagement_ratio_raw__0.677f89f9b6, now test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757)
[0m09:16:20.070842 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m09:16:20.074032 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"
[0m09:16:20.074588 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757 (compile): 09:16:20.070950 => 09:16:20.074493
[0m09:16:20.074753 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m09:16:20.076864 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"
[0m09:16:20.077451 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"
[0m09:16:20.077602 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757: BEGIN
[0m09:16:20.077737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:20.092230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:16:20.092626 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"
[0m09:16:20.092811 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select published_at
from "contentdb"."public_staging"."stg_youtube"
where published_at is null



      
    ) dbt_internal_test
[0m09:16:20.099468 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:16:20.101171 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757 (execute): 09:16:20.074856 => 09:16:20.101025
[0m09:16:20.101438 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757: ROLLBACK
[0m09:16:20.101712 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757: Close
[0m09:16:20.102198 [info ] [Thread-1 (]: 4 of 12 PASS not_null_stg_youtube_published_at ................................. [[32mPASS[0m in 0.03s]
[0m09:16:20.102717 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757
[0m09:16:20.103227 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m09:16:20.103582 [info ] [Thread-1 (]: 5 of 12 START test not_null_stg_youtube_video_id ............................... [RUN]
[0m09:16:20.104042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.not_null_stg_youtube_published_at.d60117e757, now test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79)
[0m09:16:20.104328 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m09:16:20.106465 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"
[0m09:16:20.106985 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79 (compile): 09:16:20.104458 => 09:16:20.106904
[0m09:16:20.107139 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m09:16:20.108196 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"
[0m09:16:20.109168 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"
[0m09:16:20.109545 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79: BEGIN
[0m09:16:20.109804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:20.116004 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:16:20.116320 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"
[0m09:16:20.116510 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select video_id
from "contentdb"."public_staging"."stg_youtube"
where video_id is null



      
    ) dbt_internal_test
[0m09:16:20.119160 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:16:20.120321 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79 (execute): 09:16:20.107235 => 09:16:20.120193
[0m09:16:20.120541 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79: ROLLBACK
[0m09:16:20.120800 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79: Close
[0m09:16:20.121307 [info ] [Thread-1 (]: 5 of 12 PASS not_null_stg_youtube_video_id ..................................... [[32mPASS[0m in 0.02s]
[0m09:16:20.121697 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79
[0m09:16:20.121967 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m09:16:20.122215 [info ] [Thread-1 (]: 6 of 12 START test not_null_stg_youtube_view_count ............................. [RUN]
[0m09:16:20.122601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.not_null_stg_youtube_video_id.b0e4c57c79, now test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9)
[0m09:16:20.122808 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m09:16:20.124960 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"
[0m09:16:20.125457 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9 (compile): 09:16:20.122935 => 09:16:20.125371
[0m09:16:20.125634 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m09:16:20.126658 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"
[0m09:16:20.127080 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"
[0m09:16:20.127227 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9: BEGIN
[0m09:16:20.127374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:20.135767 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:16:20.136046 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"
[0m09:16:20.136224 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select view_count
from "contentdb"."public_staging"."stg_youtube"
where view_count is null



      
    ) dbt_internal_test
[0m09:16:20.141842 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:16:20.142647 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9 (execute): 09:16:20.125733 => 09:16:20.142551
[0m09:16:20.142834 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9: ROLLBACK
[0m09:16:20.143111 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9: Close
[0m09:16:20.143661 [info ] [Thread-1 (]: 6 of 12 PASS not_null_stg_youtube_view_count ................................... [[32mPASS[0m in 0.02s]
[0m09:16:20.143972 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9
[0m09:16:20.144299 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m09:16:20.144517 [info ] [Thread-1 (]: 7 of 12 START test unique_stg_youtube_video_id ................................. [RUN]
[0m09:16:20.144874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.not_null_stg_youtube_view_count.f9903099d9, now test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1)
[0m09:16:20.145053 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m09:16:20.148291 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"
[0m09:16:20.149184 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1 (compile): 09:16:20.145158 => 09:16:20.149029
[0m09:16:20.149569 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m09:16:20.151949 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"
[0m09:16:20.153157 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"
[0m09:16:20.153335 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1: BEGIN
[0m09:16:20.153489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:20.159608 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:16:20.159893 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"
[0m09:16:20.160096 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    video_id as unique_field,
    count(*) as n_records

from "contentdb"."public_staging"."stg_youtube"
where video_id is not null
group by video_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:16:20.162996 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:16:20.163841 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1 (execute): 09:16:20.149717 => 09:16:20.163732
[0m09:16:20.164033 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1: ROLLBACK
[0m09:16:20.164268 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1: Close
[0m09:16:20.164705 [info ] [Thread-1 (]: 7 of 12 PASS unique_stg_youtube_video_id ....................................... [[32mPASS[0m in 0.02s]
[0m09:16:20.165163 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1
[0m09:16:20.165838 [debug] [Thread-1 (]: Began running node model.content_trend_advisor.features_content_engagement
[0m09:16:20.166331 [info ] [Thread-1 (]: 8 of 12 START sql table model public_marts.features_content_engagement ......... [RUN]
[0m09:16:20.166739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.unique_stg_youtube_video_id.74b61c11d1, now model.content_trend_advisor.features_content_engagement)
[0m09:16:20.166922 [debug] [Thread-1 (]: Began compiling node model.content_trend_advisor.features_content_engagement
[0m09:16:20.168509 [debug] [Thread-1 (]: Writing injected SQL for node "model.content_trend_advisor.features_content_engagement"
[0m09:16:20.170034 [debug] [Thread-1 (]: Timing info for model.content_trend_advisor.features_content_engagement (compile): 09:16:20.167026 => 09:16:20.169954
[0m09:16:20.170187 [debug] [Thread-1 (]: Began executing node model.content_trend_advisor.features_content_engagement
[0m09:16:20.183213 [debug] [Thread-1 (]: Writing runtime sql for node "model.content_trend_advisor.features_content_engagement"
[0m09:16:20.184700 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.features_content_engagement"
[0m09:16:20.184881 [debug] [Thread-1 (]: On model.content_trend_advisor.features_content_engagement: BEGIN
[0m09:16:20.185024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:20.192868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:16:20.193063 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.features_content_engagement"
[0m09:16:20.193265 [debug] [Thread-1 (]: On model.content_trend_advisor.features_content_engagement: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.features_content_engagement"} */

  
    

  create  table "contentdb"."public_marts"."features_content_engagement__dbt_tmp"
  
  
    as
  
  (
    with yt as (
    select * from "contentdb"."public_staging"."stg_youtube"
),

labeled AS (
  SELECT
    video_id,
    title,
    description,
    channel_id,
    channel_title,
    published_at,
    category_id,
    default_audio_language,
    tags,
    topic_categories,
    detected_topics,
    detected_language,
    category_name,
    view_count,
    like_count,
    comment_count,
    engagement_rate,
    engagement_ratio_raw,
    duration_seconds,
    days_since_published,

    /* Simple feature engineering */
    char_length(title)                                        AS title_len,
    CASE WHEN title ~ '\d' THEN true ELSE false END           AS title_has_numbers,
    EXTRACT(HOUR FROM published_at)                           AS hour_of_day,
    EXTRACT(DOW FROM published_at)                            AS day_of_week,

    CASE
      WHEN duration_seconds IS NULL THEN 'unknown'
      WHEN duration_seconds < 60 THEN 'short'
      WHEN duration_seconds < 300 THEN 'medium'
      WHEN duration_seconds < 900 THEN 'long'
      ELSE 'very_long'
    END                                                       AS content_length_bucket,

    CASE
      WHEN engagement_rate >= 10 THEN 'high'
      WHEN engagement_rate >= 5 THEN 'medium'
      WHEN engagement_rate >= 1 THEN 'low'
      ELSE 'very_low'
    END                                                       AS engagement_tier,

    /* Trending heuristic: fresh and non-trivial views */
    CASE
      WHEN days_since_published <= 7 AND view_count > 1000 THEN true
      ELSE false
    END                                                       AS is_trending

  FROM yt
)

SELECT * FROM labeled
  );
  
[0m09:16:20.375656 [debug] [Thread-1 (]: SQL status: SELECT 922 in 0.0 seconds
[0m09:16:20.377542 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.features_content_engagement"
[0m09:16:20.377730 [debug] [Thread-1 (]: On model.content_trend_advisor.features_content_engagement: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.features_content_engagement"} */
alter table "contentdb"."public_marts"."features_content_engagement__dbt_tmp" rename to "features_content_engagement"
[0m09:16:20.379262 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m09:16:20.381428 [debug] [Thread-1 (]: On model.content_trend_advisor.features_content_engagement: COMMIT
[0m09:16:20.381602 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.features_content_engagement"
[0m09:16:20.381743 [debug] [Thread-1 (]: On model.content_trend_advisor.features_content_engagement: COMMIT
[0m09:16:20.412851 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m09:16:20.415324 [debug] [Thread-1 (]: Applying DROP to: "contentdb"."public_marts"."features_content_engagement__dbt_backup"
[0m09:16:20.417334 [debug] [Thread-1 (]: Using postgres connection "model.content_trend_advisor.features_content_engagement"
[0m09:16:20.417605 [debug] [Thread-1 (]: On model.content_trend_advisor.features_content_engagement: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "model.content_trend_advisor.features_content_engagement"} */
drop table if exists "contentdb"."public_marts"."features_content_engagement__dbt_backup" cascade
[0m09:16:20.418749 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m09:16:20.419639 [debug] [Thread-1 (]: Timing info for model.content_trend_advisor.features_content_engagement (execute): 09:16:20.170292 => 09:16:20.419455
[0m09:16:20.419830 [debug] [Thread-1 (]: On model.content_trend_advisor.features_content_engagement: Close
[0m09:16:20.420485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15d77f20-1a69-499f-b86d-33e7c77de938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7978050>]}
[0m09:16:20.420980 [info ] [Thread-1 (]: 8 of 12 OK created sql table model public_marts.features_content_engagement .... [[32mSELECT 922[0m in 0.25s]
[0m09:16:20.421318 [debug] [Thread-1 (]: Finished running node model.content_trend_advisor.features_content_engagement
[0m09:16:20.422153 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341
[0m09:16:20.422387 [info ] [Thread-1 (]: 9 of 12 START test accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low  [RUN]
[0m09:16:20.422749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.content_trend_advisor.features_content_engagement, now test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341)
[0m09:16:20.422949 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341
[0m09:16:20.427659 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341"
[0m09:16:20.429396 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341 (compile): 09:16:20.423057 => 09:16:20.429280
[0m09:16:20.429585 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341
[0m09:16:20.430941 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341"
[0m09:16:20.431711 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341"
[0m09:16:20.431875 [debug] [Thread-1 (]: On test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341: BEGIN
[0m09:16:20.432033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:20.440354 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:16:20.441141 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341"
[0m09:16:20.441451 [debug] [Thread-1 (]: On test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        engagement_tier as value_field,
        count(*) as n_records

    from "contentdb"."public_marts"."features_content_engagement"
    group by engagement_tier

)

select *
from all_values
where value_field not in (
    'high','medium','low','very_low'
)



      
    ) dbt_internal_test
[0m09:16:20.442823 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:16:20.444071 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341 (execute): 09:16:20.429690 => 09:16:20.443968
[0m09:16:20.444309 [debug] [Thread-1 (]: On test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341: ROLLBACK
[0m09:16:20.444593 [debug] [Thread-1 (]: On test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341: Close
[0m09:16:20.445106 [info ] [Thread-1 (]: 9 of 12 PASS accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low  [[32mPASS[0m in 0.02s]
[0m09:16:20.446576 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341
[0m09:16:20.449579 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a
[0m09:16:20.449966 [info ] [Thread-1 (]: 10 of 12 START test not_null_features_content_engagement_is_trending ........... [RUN]
[0m09:16:20.451370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.accepted_values_features_content_engagement_engagement_tier__high__medium__low__very_low.afc7cef341, now test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a)
[0m09:16:20.451792 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a
[0m09:16:20.469979 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a"
[0m09:16:20.471946 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a (compile): 09:16:20.452004 => 09:16:20.471699
[0m09:16:20.472338 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a
[0m09:16:20.474812 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a"
[0m09:16:20.476171 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a"
[0m09:16:20.476385 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a: BEGIN
[0m09:16:20.476541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:20.491888 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:16:20.492229 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a"
[0m09:16:20.492426 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select is_trending
from "contentdb"."public_marts"."features_content_engagement"
where is_trending is null



      
    ) dbt_internal_test
[0m09:16:20.494032 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:16:20.495141 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a (execute): 09:16:20.472524 => 09:16:20.494993
[0m09:16:20.495466 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a: ROLLBACK
[0m09:16:20.495828 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a: Close
[0m09:16:20.496555 [info ] [Thread-1 (]: 10 of 12 PASS not_null_features_content_engagement_is_trending ................. [[32mPASS[0m in 0.05s]
[0m09:16:20.497087 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a
[0m09:16:20.497571 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7
[0m09:16:20.497966 [info ] [Thread-1 (]: 11 of 12 START test not_null_features_content_engagement_video_id .............. [RUN]
[0m09:16:20.498511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.not_null_features_content_engagement_is_trending.880e83454a, now test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7)
[0m09:16:20.498699 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7
[0m09:16:20.501424 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7"
[0m09:16:20.502164 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7 (compile): 09:16:20.498923 => 09:16:20.502066
[0m09:16:20.502332 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7
[0m09:16:20.504393 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7"
[0m09:16:20.505269 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7"
[0m09:16:20.505478 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7: BEGIN
[0m09:16:20.505737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:20.513905 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:16:20.514297 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7"
[0m09:16:20.514588 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select video_id
from "contentdb"."public_marts"."features_content_engagement"
where video_id is null



      
    ) dbt_internal_test
[0m09:16:20.516103 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:16:20.517640 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7 (execute): 09:16:20.502430 => 09:16:20.517526
[0m09:16:20.518040 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7: ROLLBACK
[0m09:16:20.518736 [debug] [Thread-1 (]: On test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7: Close
[0m09:16:20.519431 [info ] [Thread-1 (]: 11 of 12 PASS not_null_features_content_engagement_video_id .................... [[32mPASS[0m in 0.02s]
[0m09:16:20.520555 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7
[0m09:16:20.521010 [debug] [Thread-1 (]: Began running node test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221
[0m09:16:20.521793 [info ] [Thread-1 (]: 12 of 12 START test unique_features_content_engagement_video_id ................ [RUN]
[0m09:16:20.522400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.content_trend_advisor.not_null_features_content_engagement_video_id.129bf48ab7, now test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221)
[0m09:16:20.522591 [debug] [Thread-1 (]: Began compiling node test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221
[0m09:16:20.524960 [debug] [Thread-1 (]: Writing injected SQL for node "test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221"
[0m09:16:20.526001 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221 (compile): 09:16:20.522701 => 09:16:20.525899
[0m09:16:20.526167 [debug] [Thread-1 (]: Began executing node test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221
[0m09:16:20.527619 [debug] [Thread-1 (]: Writing runtime sql for node "test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221"
[0m09:16:20.528236 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221"
[0m09:16:20.528405 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221: BEGIN
[0m09:16:20.528564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:16:20.536199 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m09:16:20.536589 [debug] [Thread-1 (]: Using postgres connection "test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221"
[0m09:16:20.536843 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "content_trend_advisor", "target_name": "dev", "node_id": "test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    video_id as unique_field,
    count(*) as n_records

from "contentdb"."public_marts"."features_content_engagement"
where video_id is not null
group by video_id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:16:20.538873 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m09:16:20.539731 [debug] [Thread-1 (]: Timing info for test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221 (execute): 09:16:20.526282 => 09:16:20.539629
[0m09:16:20.539957 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221: ROLLBACK
[0m09:16:20.540178 [debug] [Thread-1 (]: On test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221: Close
[0m09:16:20.540698 [info ] [Thread-1 (]: 12 of 12 PASS unique_features_content_engagement_video_id ...................... [[32mPASS[0m in 0.02s]
[0m09:16:20.541333 [debug] [Thread-1 (]: Finished running node test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221
[0m09:16:20.543325 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:20.543611 [debug] [MainThread]: On master: BEGIN
[0m09:16:20.543748 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:16:20.550947 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m09:16:20.551405 [debug] [MainThread]: On master: COMMIT
[0m09:16:20.551598 [debug] [MainThread]: Using postgres connection "master"
[0m09:16:20.551753 [debug] [MainThread]: On master: COMMIT
[0m09:16:20.551954 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m09:16:20.552163 [debug] [MainThread]: On master: Close
[0m09:16:20.552974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:16:20.553199 [debug] [MainThread]: Connection 'list_contentdb' was properly closed.
[0m09:16:20.553465 [debug] [MainThread]: Connection 'test.content_trend_advisor.unique_features_content_engagement_video_id.cd56a0c221' was properly closed.
[0m09:16:20.553991 [info ] [MainThread]: 
[0m09:16:20.554275 [info ] [MainThread]: Finished running 1 view model, 10 tests, 1 table model in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m09:16:20.555541 [debug] [MainThread]: Command end result
[0m09:16:20.583785 [info ] [MainThread]: 
[0m09:16:20.584208 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:16:20.585030 [info ] [MainThread]: 
[0m09:16:20.589323 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m09:16:20.597555 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.9563494, "process_user_time": 2.025705, "process_kernel_time": 0.538716, "process_mem_max_rss": "136008", "process_out_blocks": "3613", "process_in_blocks": "0"}
[0m09:16:20.598564 [debug] [MainThread]: Command `dbt build` succeeded at 09:16:20.598456 after 1.96 seconds
[0m09:16:20.599144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa934cc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa97a62d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9937710>]}
[0m09:16:20.599555 [debug] [MainThread]: Flushing usage events
